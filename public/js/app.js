"use strict";$(function(){function e(){I=v%2==0?"Player 2":"Player 1"}function n(){for(var e=0;e<f;e++){var n=Math.floor(8*Math.random());O.push(c[h[n]])}console.log("initializing!"),a()}function a(){g=[],setTimeout(function(){if(!(y<f))return void(y=0);a(),i(O[y]),u.addClass("hidden"),u.html(I),console.log(O[y].audio),y++},1e3)}function i(e){s.src="audio/"+e.audio+".wav",s.play();var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),$(".numberDisplay").html(e),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function t(){var n=g.length===O.length&&g.every(function(e,n){return e===O[n].audio});if((T+=1)===f&&0===k&&!0!==C)if(console.log(n),!0===n){var i=Math.floor(8*Math.random());O.push(c[h[i]]),console.log(O),g=[],T=0,f+=1,v+=1,e(),u.html("Pass! - next up "+I),u.removeClass("hidden"),setTimeout(a,3e3)}else!1===n&&!0!==C&&(g=[],T=0,k+=1,v+=1,setTimeout(a,3e3),e(),u.html("Fail! sudden death!! -next up "+I),u.removeClass("hidden"));else T===f&&0!==k&&!0!==C&&(!0===n?(u.html(I+" Wins!"),u.removeClass("hidden"),r.removeClass("hidden")):!1===n&&!0!==C&&(u.html(I+" Fails!! ---- TIE!"),u.removeClass("hidden"),r.removeClass("hidden")))}console.log("JS yo");var o=$(document),s=$("audio")[0],l=$(".welcome"),d=$("#game"),m=$("#playground"),u=$(".feedback"),r=($(".reset"),$(".endgame")),h=($(".switch"),[49,50,51,52,53,54,55,56]),c={49:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:49},50:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:50},51:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:51},52:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:52},53:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:53},54:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:54},55:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:55},56:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:56}},f=3,v=f,O=[],g=[],C=!1,p=!1,I="player 1";o.keypress(function(e){var n=c[e.charCode];(!0===p||!0===C&&n)&&(i(n),$(".numberDisplay").html(e.key))}),d.on("click",function(){l.hide(),p=!0,u.removeClass("hidden"),u.html(I),setTimeout(n,3e3)}),m.on("click",function(){l.hide(),C=!0,r.removeClass("hidden")});var y=0;!function(){console.log("listening..."),o.keypress(function(e){g.push(e.charCode),t()})}();var k=0,T=0;r.on("click",function(){f=3,v=f,O=[],g=[],p=!1,C=!1,e(),k=0,T=0,u.html(""),l.show(),r.addClass("hidden")})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwidXBkYXRlUGxheWVyIiwiY3VycmVudFBsYXllciIsImdhbWVJbml0IiwiY29uc29sZSIsImxvZyIsImkiLCJjdXJyZW50Um91bmQiLCJwbGF5QmFjayIsInByb2dyYW1TZXF1ZW5jZSIsInB1c2giLCJ2aXN1YWxzIiwic291bmRzIiwicmFuZCIsIiRmZWVkYmFjayIsInNlcXVlbmNlSW5kZXgiLCJ2aXN1YWxpc2UiLCJodG1sIiwiYXVkaW8iLCJwYXR0ZXJuIiwiJGVsZW1lbnQiLCJyZW1vdmVDbGFzcyIsInBsYXkiLCJzZXRUaW1lb3V0IiwiZWxlbWVudCIsImNsb25lIiwiYWRkQ2xhc3MiLCJhbmltYXRpb25JbiIsImFuaW1hdGlvbk91dCIsInJlbW92ZSIsInVzZXJTZXF1ZW5jZSIsImNvdW50IiwibGVuZ3RoIiwiZXZlcnkiLCJ2IiwiY3VycmVudFBsYXllck51bSIsImxvc3NlcyIsIm1lc3NpbmciLCJNYXRoIiwicmFuZG9tIiwidGhlU2FtZSIsIiRlbmRHYW1lIiwicGxheWluZyIsImRvY3VtZW50IiwiJGRvY3VtZW50IiwiJHdlbGNvbWUiLCIkZ2FtZSIsIiRwbGF5Z3JvdW5kIiwiJHN3aXRjaCIsIjQ5IiwiNTAiLCI1MSIsIjUyIiwiNTMiLCI1NCIsIjU1IiwiNTYiLCJlIiwiY2hhckNvZGUiLCJrZXkiLCJvbiIsImhpZGUiLCJsaXN0ZW4iLCJrZXlwcmVzcyIsImNvbXBhcmVBcnJheXMiLCJzaG93Il0sIm1hcHBpbmdzIjoiWUFBQUEsR0FBRSxXQXVIRyxRQUFNQyxLQUVOQyxFQURDQSxFQUFnQixHQUFoQixFQUNELFdBR2tCLFdBSWxCLFFBQUFDLEtBQ0RDLElBQUFBLEdBQVFDLEdBQUksRUFBQUMsRUFBQUMsRUFBWkQsSUFBQSxDQUNBRSxHQUFBQSxHQUFBQSxLQUFBQSxNQUFBQSxFQUFBQSxLQUFBQSxTQUNEQyxHQUFBQyxLQUFBQyxFQUFBQyxFQUFBQyxLQUdEVCxRQUFBQyxJQUFBLGlCQUpFRyxJ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LElBSEUyQixJQU1KL0IsUUFBSXhCLEVBQUEsWUFDRndCLFlBQVcsUUFDWEcsYUFBYSxVQUNiQyxNQUFBQSxJQUhFNEIsSUFNSmhDLFFBQUl4QixFQUFBLFdBQ0Z3QixZQUFXLGNBQ1hHLGFBQWEsVUFDYkMsTUFBQUEsS0FVQXJCLEVBQWUsRUFBZkEsRUFBSkEsRUFJSUUsS0FDQXFCLEtBTUFZLEdBQVUsRUFBVkEsR0FBVSxFQU1keEMsRUFBQSxVQUlJYyxHQUFBQSxTQUFVRyxTQUFWc0MsR0FDQXpELEdBQUVtQixHQUFBUixFQUFrQk0sRUFBcEJ5QyxZQUNELElBQUFoQixJQUFBLElBQUFMLEdBQUFsQixLQUxISCxFQUFBRyxHQUlJbkIsRUFBRSxrQkFBa0JpQixLQUFLd0MsRUFBRUUsUUFXN0I3QyxFQUFBQSxHQUFBQSxRQUFlWixXQUNmcUIsRUFBQUEsT0FMRm1CLEdBQUEsRUFHRTVCLEVBQVVPLFlBQVksVUFLeEIwQixFQUFZYSxLQUFHMUQsR0FDYjJDLFdBQVNnQixFQUFULE9BR0RkLEVBSkRhLEdBQUEsUUFBQSxXQUNFZixFQUFTZ0IsT0FLWHhCLEdBQVNwQyxFQUNQd0MsRUFBSU4sWUFBQUEsV0EyQkYsSUFBQXBCLEdBQUlBLEdBaURQLFdBRUQrQyxRQUFBQSxJQUFBQSxnQkFSRWxCLEVBQVVtQixTQUFTLFNBQVNOLEdBVTFCckIsRUFBSjFCLEtBQUErQyxFQUFBQyxVQVBJTSxRQWdCbUYsSUFBckY1QixHQUFBLEVBQ0FMLEVBQUEsQ0F1REFVLEdBQUFBLEdBQVNmLFFBQVMsV0FacEJuQixFQUFBLEVBelBGNEIsRUFBQTVCLEVBNFBJRSxLQUNBcUIsS0FDQVksR0FBVSxFQUNWTCxHQUFVLEVBQ1ZwQyxJQUNBbUMsRUFBUyxFQUNUTCxFQUFRLEVBQ1JqQixFQUFVRyxLQUFLLElBQ2Y0QixFQUFTb0IsT0FDVHhCLEVBQVNmLFNBQVMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdKUyB5bycpO1xuXG4gIGNvbnN0ICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuICBjb25zdCBhdWRpbyA9ICQoJ2F1ZGlvJylbMF07XG4gIGNvbnN0ICR3ZWxjb21lID0gJCgnLndlbGNvbWUnKTtcbiAgY29uc3QgJGdhbWUgPSAkKCcjZ2FtZScpO1xuICBjb25zdCAkcGxheWdyb3VuZCA9ICQoJyNwbGF5Z3JvdW5kJyk7XG4gIGNvbnN0ICRmZWVkYmFjayA9ICQoJy5mZWVkYmFjaycpO1xuICBjb25zdCAkcmVzZXQgPSAkKCcucmVzZXQnKTtcbiAgY29uc3QgJGVuZEdhbWUgPSAkKCcuZW5kZ2FtZScpO1xuICBjb25zdCAkc3dpdGNoID0gJCgnLnN3aXRjaCcpO1xuXG4gIGNvbnN0IHNvdW5kcyA9IFs0OSwgNTAsIDUxLCA1MiwgNTMsIDU0LCA1NSwgNTZdO1xuXG5cbiAgY29uc3QgdmlzdWFscyA9IHtcbiAgICA0OToge1xuICAgICAgZWxlbWVudDogJCgnLmZpcnN0JyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZhZGVJbkRvd25CaWcnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnem9vbU91dCcsXG4gICAgICBhdWRpbzogNDlcbiAgICB9LFxuICAgIDUwOiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2Vjb25kJyksXG4gICAgICBhbmltYXRpb25JbjogJ3pvb21JbicsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1MFxuICAgIH0sXG4gICAgNTE6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy50aGlyZCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmbGFzaCcsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1MVxuICAgIH0sXG4gICAgNTI6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5mb3VydGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAncm90YXRlSW4nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAncm90YXRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1MlxuICAgIH0sXG4gICAgNTM6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5maWZ0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmbGFzaHR3bycsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1M1xuICAgIH0sXG4gICAgNTQ6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zaXh0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmYWRlSW5VcEJpZycsXG4gICAgICBhbmltYXRpb25PdXQ6ICdsaWdodFNwZWVkT3V0JyxcbiAgICAgIGF1ZGlvOiA1NFxuICAgIH0sXG4gICAgNTU6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zZXZlbnRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ3NoYWtlJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDU1XG4gICAgfSxcbiAgICA1Njoge1xuICAgICAgZWxlbWVudDogJCgnLmVpZ2h0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdzbGlkZUluTGVmdCcsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1NlxuICAgIH1cblxuICB9O1xuXG4gIC8vIGN1cnJlbnQgcm91bmQuIGVtcHR5IHByb2dyYW1TZXF1ZW5jZSBhcnJheSxcbiAgLy9nZXRzIGZpbGxlZCB4MyBhdCBzdGFydCB0aGVuIGlzICsxIHBlciByb3VuZFxuXG5cbiAgbGV0IGN1cnJlbnRSb3VuZCA9IDM7XG4gIGxldCBjdXJyZW50UGxheWVyTnVtID0gY3VycmVudFJvdW5kO1xuXG5cbiAgbGV0IHByb2dyYW1TZXF1ZW5jZSA9IFtdO1xuICBsZXQgdXNlclNlcXVlbmNlID0gW107XG4gIGxldCBudW1Db2RlID0gbnVsbDtcblxuXG4gIC8vUGxheWluZyB5ZXMvIG5vIHN3aXRjaFxuICBsZXQgbWVzc2luZyA9IGZhbHNlO1xuICBsZXQgcGxheWluZyA9IGZhbHNlO1xuXG5cbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSAncGxheWVyIDEnO1xuXG5cbiAgLy9hc3NpZ25zIHRoZSBhdWRpbyBzcmMgYWNjb3JkaW5nIHRvIGtleXByZXNzIGlkIG9mIGtleXMgMS04LlxuICAkZG9jdW1lbnQua2V5cHJlc3MoZnVuY3Rpb24oZSkge1xuICAgIGNvbnN0IHBhdHRlcm4gPSB2aXN1YWxzW2UuY2hhckNvZGVdO1xuICAgIGlmICgocGxheWluZyA9PT0gdHJ1ZSkgfHwgKG1lc3NpbmcgPT09IHRydWUpICYmIHBhdHRlcm4pIHtcbiAgICAgIHZpc3VhbGlzZShwYXR0ZXJuKTtcbiAgICAgICQoJy5udW1iZXJEaXNwbGF5JykuaHRtbChlLmtleSk7XG4gICAgfVxuICB9KTtcblxuXG4gIC8vc3dpdGNoZXMgcGxheWluZyB2YXIgdG8gdHJ1ZSBhbmQgaW5pdGlhbHplcyB0aGUgZ2FtZSA6KVxuICAvL2hpZGVzIHRoZSB3ZWxjb21lIGRpdlxuICAkZ2FtZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJHdlbGNvbWUuaGlkZSgpO1xuICAgIHBsYXlpbmcgPSB0cnVlO1xuICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgc2V0VGltZW91dChnYW1lSW5pdCwgMzAwMCk7XG4gIH0pO1xuXG4gICRwbGF5Z3JvdW5kLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAkd2VsY29tZS5oaWRlKCk7XG4gICAgbWVzc2luZyA9IHRydWU7XG4gICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICB9KTtcblxuICBmdW5jdGlvbiB1cGRhdGVQbGF5ZXIgKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyTnVtICUgMiA9PT0gMCkge1xuICAgICAgY3VycmVudFBsYXllciA9ICdQbGF5ZXIgMic7XG4gICAgICAvLyBjb25zb2xlLmxvZyhjdXJyZW50Um91bmQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50UGxheWVyID0gJ1BsYXllciAxJztcbiAgICB9XG4gIH1cbiAgLy9pbml0aWFsaXplcyB0aGUgYnVpbGRpbmcgb2YgdGhlIHByb2dyYW0gYXJyYXlcbiAgZnVuY3Rpb24gZ2FtZUluaXQgKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFJvdW5kOyBpKyspe1xuICAgICAgY29uc3QgcmFuZCA9IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqOCkpO1xuICAgICAgcHJvZ3JhbVNlcXVlbmNlLnB1c2godmlzdWFsc1tzb3VuZHNbcmFuZF1dKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ2luaXRpYWxpemluZyEnKTtcbiAgICBwbGF5QmFjaygpO1xuICB9XG5cblxuICAvLyBoZXJlIGRvZXMgdGhlcmUgbmVlZCB0byBiZSBhIGdhbWUgYWRkIHJhbmRvbSBhZGRpdGlvbiB0byBhcnJheSBPUiBhIHdheSBvZiB1c2luZyB0aGUgYWJvdmUgZnVuY3Rpb24ganVzdCB0byBhZGQgb25lP1xuXG4gIC8vdGhpcyBwbGF5cyBiYWNrIHRoZSBjb25zdHJ1Y3RlZCBwcm9ncmFtIGFycmF5XG4gIGxldCBzZXF1ZW5jZUluZGV4ID0gMDtcblxuXG4gIGZ1bmN0aW9uIHBsYXlCYWNrKCkge1xuICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHNlcXVlbmNlSW5kZXggPCBjdXJyZW50Um91bmQpIHtcbiAgICAgICAgcGxheUJhY2soKTtcbiAgICAgICAgdmlzdWFsaXNlKHByb2dyYW1TZXF1ZW5jZVtzZXF1ZW5jZUluZGV4XSk7XG4gICAgICAgICRmZWVkYmFjay5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9ncmFtU2VxdWVuY2Vbc2VxdWVuY2VJbmRleF0uYXVkaW8pO1xuICAgICAgICBzZXF1ZW5jZUluZGV4Kys7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIHNlcXVlbmNlSW5kZXggPSAwO1xuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHZpc3VhbGlzZSAocGF0dGVybikge1xuICAgIC8vICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIpO1xuICAgIGF1ZGlvLnNyYyA9IGBhdWRpby8ke3BhdHRlcm4uYXVkaW99LndhdmA7XG4gICAgYXVkaW8ucGxheSgpO1xuICAgIGNvbnN0ICRlbGVtZW50ID0gcGF0dGVybi5lbGVtZW50LmNsb25lKCk7XG4gICAgJGVsZW1lbnQuYXBwZW5kVG8oJ21haW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYWRkQ2xhc3MocGF0dGVybi5hbmltYXRpb25JbikucmVtb3ZlQ2xhc3MocGF0dGVybi5hbmltYXRpb25PdXQpO1xuICAgICQoJy5udW1iZXJEaXNwbGF5JykuaHRtbChwYXR0ZXJuKTtcbiAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcyhwYXR0ZXJuLmFuaW1hdGlvbkluKS5hZGRDbGFzcyhwYXR0ZXJuLmFuaW1hdGlvbk91dCk7XG4gICAgfSwgMTIwMCk7XG4gICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSwgMTkwMCk7XG5cblxuICAgIC8vIGNvbnN0ICRuZXdkaXYgPSAkKCAnPGRpdiBpZD1cImVhc3lcIj48L2Rpdj4nICk7XG4gICAgLy8gaWYgKCRzd2l0Y2guY2hlY2tlZCkge1xuICAgIC8vICAgY29uc29sZS5sb2coJ3N3aXRjaHkgY2hlY2tlZCEhJyk7XG4gICAgLy8gICAvLyAkbmV3ZGl2LmFwcGVuZFRvKCdtYWluJylcbiAgICAvLyB9XG5cbiAgfVxuXG4gIC8vRnVuY3Rpb24gcHVzaGVzIGtleSBjaGFyY29kZXMgdGhlIHVzZXIgaW5wdXRzIHRvIHRoZSB1c2VyU2VxdWVuY2UgYXJyYXkuXG4gIGZ1bmN0aW9uIGxpc3RlbigpIHtcbiAgICAvLyBpZiAocGxheWluZyA9PT0gdHJ1ZSkge1xuICAgIGNvbnNvbGUubG9nKCdsaXN0ZW5pbmcuLi4nKTtcbiAgICAkZG9jdW1lbnQua2V5cHJlc3MoZnVuY3Rpb24oZSkge1xuICAgICAgdXNlclNlcXVlbmNlLnB1c2goZS5jaGFyQ29kZSk7XG4gICAgICAvLyBjb25zb2xlLmxvZyh1c2VyU2VxdWVuY2UpO1xuICAgICAgY29tcGFyZUFycmF5cygpO1xuICAgIH0pO1xuXG4gIH1cblxuICBsaXN0ZW4oKTtcblxuICBsZXQgbG9zc2VzID0gMDtcbiAgbGV0IGNvdW50ICA9IDA7XG5cblxuXG4gIC8vIGNvbXBhcmVzIHRoZSB0d28gYXJyYXlzIHdoZW4gdGhlIGxlbmd0aCBtYXRjaGVzIHRoZSBjdXJyZW50IHJvdW5kLlxuICAvLyBub3Qgc3VwZXIgc2ljayxjb3VsZG50IGdldCBpdCBzdG9wIHRyaWdnZXJpbmcgb24gZXZlcnkga2V5cHJlc3NcbiAgLy8gaWYgcGxheWVyIHBhc3NlcyB0ZXN0ICsxIGlzIGFkZGVkIHRvIHJvdW5kIGxlbmd0aCBhbmQgcGxheWJhY2sgc3RhcnRzIGFnYWluLlxuICBmdW5jdGlvbiBjb21wYXJlQXJyYXlzKCkge1xuICAgIGNvbnN0IHRoZVNhbWUgPSB1c2VyU2VxdWVuY2UubGVuZ3RoID09PSBwcm9ncmFtU2VxdWVuY2UubGVuZ3RoICYmIHVzZXJTZXF1ZW5jZS5ldmVyeSgodixpKSA9PiB2ID09PSBwcm9ncmFtU2VxdWVuY2VbaV0uYXVkaW8pO1xuICAgIGNvdW50ICs9IDE7XG4gICAgaWYgKChjb3VudCA9PT0gY3VycmVudFJvdW5kKSAmJiAobG9zc2VzID09PSAwKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoZVNhbWUpO1xuICAgICAgaWYgKHRoZVNhbWUgPT09IHRydWUpIHtcbiAgICAgICAgY29uc3QgcmFuZCA9IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqOCkpO1xuICAgICAgICBwcm9ncmFtU2VxdWVuY2UucHVzaCh2aXN1YWxzW3NvdW5kc1tyYW5kXV0pO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9ncmFtU2VxdWVuY2UpO1xuICAgICAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICAgICAgY291bnQgPSAwO1xuICAgICAgICBjdXJyZW50Um91bmQgKz0gMTtcbiAgICAgICAgY3VycmVudFBsYXllck51bSArPSAxO1xuICAgICAgICB1cGRhdGVQbGF5ZXIoKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoJ1Bhc3MhIC0gbmV4dCB1cCAnICsgY3VycmVudFBsYXllcik7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgIHNldFRpbWVvdXQocGxheUJhY2ssIDMwMDApO1xuICAgICAgfSBlbHNlIGlmICgodGhlU2FtZSA9PT0gZmFsc2UpICYmIChtZXNzaW5nICE9PSB0cnVlKSkge1xuICAgICAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICAgICAgY291bnQgPSAwO1xuICAgICAgICBsb3NzZXMgKz0gMTtcbiAgICAgICAgY3VycmVudFBsYXllck51bSArPSAxO1xuICAgICAgICBzZXRUaW1lb3V0KHBsYXlCYWNrLCAzMDAwKTtcbiAgICAgICAgdXBkYXRlUGxheWVyKCk7XG4gICAgICAgICRmZWVkYmFjay5odG1sKCdGYWlsISBzdWRkZW4gZGVhdGghISAtbmV4dCB1cCAnICsgY3VycmVudFBsYXllcik7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cblxuXG4gICAgICAgIC8vdGhpcyBib3R0b20gcGFydCBvZiB0aGUgaWYgZWxzZSBhY3RzIGFzIHRoZSBzdWRkZW4gZGVhdGggY2FsY3VsYXRvciBwb3J0aW9uIG9mIHRoZSBnYW1lLCB3b3JrcyBvbiB3aGV0aGVyIGEgbG9zcyB3YXMgc3RvcmVkIGluIHRoZSAnbG9zc2VzJyB2YXIuXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICgoY291bnQgPT09IGN1cnJlbnRSb3VuZCkgJiYgKGxvc3NlcyAhPT0gMCkgJiYgKG1lc3NpbmcgIT09IHRydWUpKXtcbiAgICAgIGlmICh0aGVTYW1lID09PSB0cnVlKSB7XG4gICAgICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIgKyAnIFdpbnMhJyk7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRlbmRHYW1lLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgIH0gZWxzZSBpZiAoKHRoZVNhbWUgPT09IGZhbHNlKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpIHtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllciArICcgRmFpbHMhISAtLS0tIFRJRSEnKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgJGVuZEdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgIGN1cnJlbnRSb3VuZCA9IDM7XG4gICAgY3VycmVudFBsYXllck51bSA9IGN1cnJlbnRSb3VuZDtcbiAgICBwcm9ncmFtU2VxdWVuY2UgPSBbXTtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgbWVzc2luZyA9IGZhbHNlO1xuICAgIHVwZGF0ZVBsYXllcigpO1xuICAgIGxvc3NlcyA9IDA7XG4gICAgY291bnQgPSAwO1xuICAgICRmZWVkYmFjay5odG1sKCcnKTtcbiAgICAkd2VsY29tZS5zaG93KCk7XG4gICAgJGVuZEdhbWUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICB9KTtcblxuXG59KTtcbiJdfQ==
