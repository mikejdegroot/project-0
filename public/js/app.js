"use strict";$(function(){function e(e){if(!0===x||!0===b){var n=I[e.key],i=e.key;u(n),w.push(parseInt(e.key)),g.removeClass("hiddener"),g.html(i),setTimeout(o,500),l()}}function n(){w=[],T=[]}function i(){g.toggleClass("hidden")}function t(){M=k%2==0?"Player 2":"Player 1"}function a(e){g.removeClass("hiddener"),g.html(e),setTimeout(o,500)}function o(){g.addClass("hiddener")}function s(){for(var e=0;e<y;e++){var n=Math.floor(8*Math.random());T.push(I[p[n]])}console.log("initializing!"),d()}function d(){w=[],setTimeout(function(){if(!(z<y))return z=0,void(w=[]);d(),u(T[z]),v.addClass("hidden"),v.html(M),z++},1e3)}function u(e){r.src="src/assets/audio/"+e.audio+".wav",r.play(),a(e.audio);var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function l(){var e=w.length===T.length&&w.every(function(e,n){return e===T[n].audio});if((B+=1)===y&&0===P&&!0!==b&&!0===x)if(console.log(e),!0===e){var n=Math.floor(8*Math.random());T.push(I[p[n]]),w=[],B=0,y+=1,k+=1,t(),v.html("Pass! - next up "+M),v.removeClass("hidden"),setTimeout(d,3e3)}else!1===e&&!0!==b&&(w=[],B=0,P+=1,k+=1,setTimeout(d,3e3),t(),v.html("Fail! sudden death!! -next up "+M),v.removeClass("hidden"));else B===y&&0!==P&&!0!==b&&(!0===e?(v.html(M+" Wins!"),v.removeClass("hidden"),C.removeClass("hidden")):!1===e&&!0!==b&&(v.html(M+" Fails!! ---- TIE!"),v.removeClass("hidden"),C.removeClass("hidden")))}console.log("JS yo");var m=$(document),r=$("audio")[0],h=$(".welcome"),c=$("#game"),f=$("#playground"),v=$(".feedback"),C=($(".reset"),$(".endgame")),O=$(".switch"),g=$(".numberDisplay"),p=[1,2,3,4,5,6,7,8],I={1:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:1},2:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:2},3:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:3},4:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:4},5:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:5},6:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:6},7:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:7},8:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:8}},y=3,k=y,T=[],w=[],M="player 1",b=!1,x=!1;c.on("click",function(){h.hide(),x=!0,v.removeClass("hidden"),v.html(M),n(),m.keypress(e),setTimeout(s,3e3)}),f.on("click",function(){h.hide(),b=!0,C.removeClass("hidden"),n(),m.keypress(e)}),O.on("change",function(){console.log("checked"),i()});var z=0,P=0,B=0;C.on("click",function(){y=3,k=y,T=[],w=[],x=!1,b=!1,t(),P=0,B=0,v.html(""),h.show(),C.addClass("hidden"),m.unbind("keypress",e)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwidmlzdWFsaXNlIiwiZSIsInVzZXJTZXF1ZW5jZSIsInB1c2giLCJwYXJzZUludCIsIiRudW1iZXJEaXNwbGF5IiwicmVtb3ZlQ2xhc3MiLCJodG1sIiwic2V0VGltZW91dCIsImNvbXBhcmVBcnJheXMiLCJza2V5IiwiaGlkZUtleSIsIiRzd2l0Y2giLCJvbiIsImNvbnNvbGUiLCJoYXJkTW9kZSIsImN1cnJlbnRQbGF5ZXIiLCJhZGRDbGFzcyIsInJhbmQiLCJNYXRoIiwicHJvZ3JhbVNlcXVlbmNlIiwidmlzdWFscyIsImtleSIsInNlcXVlbmNlSW5kZXgiLCJpIiwicGxheUJhY2siLCJzb3VuZHMiLCIkZmVlZGJhY2siLCJhdWRpbyIsInBsYXkiLCJjdXJyZW50Um91bmQiLCJlYXN5UGxheSIsIiRlbGVtZW50IiwiYXBwZW5kVG8iLCJzcmMiLCJsb3NzZXMiLCJlbGVtZW50IiwiY2xvbmUiLCJjb3VudCIsImFuaW1hdGlvbkluIiwiYW5pbWF0aW9uT3V0IiwidGhlU2FtZSIsImxlbmd0aCIsImV2ZXJ5IiwidiIsIm1lc3NpbmciLCJwbGF5aW5nIiwibG9nIiwiJGVuZEdhbWUiLCJ1cGRhdGVQbGF5ZXIiLCJjdXJyZW50UGxheWVyTnVtIiwidW5iaW5kIiwiZG9jdW1lbnQiLCIkZG9jdW1lbnQiLCIkd2VsY29tZSIsIiRnYW1lIiwiJHBsYXlncm91bmQiLCIkcmVzZXQiLCIxIiwiMiIsIjMiLCI0IiwiNSIsIjYiLCI3IiwiOCIsImJ1aWxkR2FtZSIsImtleXByZXNzIiwia2V5TGlzdGVuZXIiLCJnYW1lSW5pdCIsInNob3ciXSwibWFwcGluZ3MiOiJZQUFBQSxHQUFFLFdBaUhJQyxRQUFBQSxHQUFBQyxHQUNBQyxJQUFhQyxJQUFiRCxJQUFBLElBQWtCRSxFQUFsQixDQUNBQyxHQUFBQSxHQUFBQSxFQUFlQyxFQUFBQSxLQUNmRCxFQUFBQSxFQUFlRSxHQUNmQyxHQUFBQSxHQUNBQyxFQUFBQSxLQUFBQSxTQUFB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U0FBQSxXQVBDQyxRQUFRaUMsSUFBSSxXQWFkaEMsS0F3REssSUFBQVEsR0FBQSxFQWdFQVksRUFBTSxFQUNMakMsRUFBQUEsQ0EyQk44QyxHQUFTbkMsR0FBRyxRQUFTLFdBQ25CaUIsRUFBZSxFQUNmb0IsRUFBbUJwQixFQUNuQlYsS0FDQWxCLEtBQ0E0QyxHQUFVLEVBQ1ZELEdBQVUsRUFFVkksSUFDQWQsRUFBUyxFQUNURyxFQUFRLEVBQ1JYLEVBQVVwQixLQUFLLElBQ2YrQyxFQUFTZ0IsT0FDVHRCLEVBQVMvQixTQUFTLFVBQ2xCb0MsRUFBVUYsT0FBTyxXQUFZaUIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdKUyB5bycpO1xuXG4gIGNvbnN0ICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuICAvLyBjb25zdCAkY2hlY2tib3ggPSAkKCdjaGVja2JveCcpO1xuICBjb25zdCBhdWRpbyA9ICQoJ2F1ZGlvJylbMF07XG4gIGNvbnN0ICR3ZWxjb21lID0gJCgnLndlbGNvbWUnKTtcbiAgY29uc3QgJGdhbWUgPSAkKCcjZ2FtZScpO1xuICBjb25zdCAkcGxheWdyb3VuZCA9ICQoJyNwbGF5Z3JvdW5kJyk7XG4gIGNvbnN0ICRmZWVkYmFjayA9ICQoJy5mZWVkYmFjaycpO1xuICBjb25zdCAkcmVzZXQgPSAkKCcucmVzZXQnKTtcbiAgY29uc3QgJGVuZEdhbWUgPSAkKCcuZW5kZ2FtZScpO1xuICBjb25zdCAkc3dpdGNoID0gJCgnLnN3aXRjaCcpO1xuICBjb25zdCAkbnVtYmVyRGlzcGxheSA9ICQoJy5udW1iZXJEaXNwbGF5JylcblxuICBjb25zdCBzb3VuZHMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOF07XG5cblxuICBjb25zdCB2aXN1YWxzID0ge1xuICAgIDE6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5maXJzdCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmYWRlSW5Eb3duQmlnJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ3pvb21PdXQnLFxuICAgICAgYXVkaW86IDFcbiAgICB9LFxuICAgIDI6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zZWNvbmQnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnem9vbUluJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDJcbiAgICB9LFxuICAgIDM6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy50aGlyZCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmbGFzaCcsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiAzXG4gICAgfSxcbiAgICA0OiB7XG4gICAgICBlbGVtZW50OiAkKCcuZm91cnRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ3JvdGF0ZUluJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ3JvdGF0ZU91dCcsXG4gICAgICBhdWRpbzogNFxuICAgIH0sXG4gICAgNToge1xuICAgICAgZWxlbWVudDogJCgnLmZpZnRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZsYXNodHdvJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDVcbiAgICB9LFxuICAgIDY6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zaXh0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmYWRlSW5VcEJpZycsXG4gICAgICBhbmltYXRpb25PdXQ6ICdsaWdodFNwZWVkT3V0JyxcbiAgICAgIGF1ZGlvOiA2XG4gICAgfSxcbiAgICA3OiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2V2ZW50aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdzaGFrZScsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA3XG4gICAgfSxcbiAgICA4OiB7XG4gICAgICBlbGVtZW50OiAkKCcuZWlnaHRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ3NsaWRlSW5MZWZ0JyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDhcbiAgICB9XG5cbiAgfTtcblxuICAvLyBjdXJyZW50IHJvdW5kLiBlbXB0eSBwcm9ncmFtU2VxdWVuY2UgYXJyYXksXG4gIC8vZ2V0cyBmaWxsZWQgeDMgYXQgc3RhcnQgdGhlbiBpcyArMSBwZXIgcm91bmRcbiAgbGV0IGN1cnJlbnRSb3VuZCA9IDM7XG4gIGxldCBjdXJyZW50UGxheWVyTnVtID0gY3VycmVudFJvdW5kO1xuICBsZXQgcHJvZ3JhbVNlcXVlbmNlID0gW107XG4gIGxldCB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgbGV0IGN1cnJlbnRQbGF5ZXIgPSAncGxheWVyIDEnO1xuXG4gIC8vUGxheWluZy9tZXNzaW5nIG1vZGUgdmFycyBmb3IgZ2FtZSBvciBwbGF5Z3JvdW5kXG4gIGxldCBtZXNzaW5nID0gZmFsc2U7XG4gIGxldCBwbGF5aW5nID0gZmFsc2U7XG5cblxuXG5cbiAvL2dhbWUgYnV0dG9uIGNsaWNrIGZ1bmN0aW9uLSBzaG93cyBjdXJyZW50IHBsYXllciwgc3dpdGNoZXMgcGxheWluZyB0byB0cnVlIGFuZCAgbGF1bmNoZXMgdGhlIGtleSBsaXN0ZW5lciBhbmQgdGhlIGJ1aWxkZ2FtZSBmdW5jdGlvbi5cbiAgJGdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICR3ZWxjb21lLmhpZGUoKTtcbiAgICBwbGF5aW5nID0gdHJ1ZTtcbiAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIpO1xuICAgIGJ1aWxkR2FtZSgpO1xuICAgICRkb2N1bWVudC5rZXlwcmVzcyhrZXlMaXN0ZW5lcik7XG4gICAgc2V0VGltZW91dChnYW1lSW5pdCwgMzAwMCk7XG4gIH0pO1xuXG4vL3BsYXlncm91bmQgYnV0dG9uIGtleSBsaXN0ZW5lci5cbiAgJHBsYXlncm91bmQub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICR3ZWxjb21lLmhpZGUoKTtcbiAgICBtZXNzaW5nID0gdHJ1ZTtcbiAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgYnVpbGRHYW1lKCk7XG4gICAgJGRvY3VtZW50LmtleXByZXNzKGtleUxpc3RlbmVyKTtcblxuICB9KTtcblxuXG4gIC8vYXNzaWducyB0aGUgYXVkaW8gc3JjIGFjY29yZGluZyB0byBrZXlwcmVzcyBpZCBvZiBrZXlzIDEtOC5cbiAgLy8gZnVuY3Rpb24ga2V5TGlzdGVuZXIgKCkge1xuICBmdW5jdGlvbiBrZXlMaXN0ZW5lcihlKSB7XG4gICAgaWYgKChwbGF5aW5nID09PSB0cnVlKSB8fCAobWVzc2luZyA9PT0gdHJ1ZSkpIHtcbiAgICAgIGNvbnN0IGtleSA9IHZpc3VhbHNbZS5rZXldO1xuICAgICAgY29uc3Qgc2tleSA9IGUua2V5O1xuICAgICAgdmlzdWFsaXNlKGtleSk7XG4gICAgICB1c2VyU2VxdWVuY2UucHVzaChwYXJzZUludChlLmtleSkpO1xuICAgICAgJG51bWJlckRpc3BsYXkucmVtb3ZlQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gICAgICAkbnVtYmVyRGlzcGxheS5odG1sKHNrZXkpO1xuICAgICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuICAgICAgY29tcGFyZUFycmF5cygpO1xuICAgIH1cbiAgfVxuXG4gIC8vc3dpdGNoZXMgcGxheWluZyB2YXIgdG8gdHJ1ZSBhbmQgaW5pdGlhbHplcyB0aGUgZ2FtZSA6KVxuICAvL2hpZGVzIHRoZSB3ZWxjb21lIGRpdlxuXG5cblxuICBmdW5jdGlvbiBidWlsZEdhbWUoKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgcHJvZ3JhbVNlcXVlbmNlID0gW107XG4gIH1cblxuXG5cbiAgJHN3aXRjaC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdjaGVja2VkJyk7XG4gICAgaGFyZE1vZGUoKTtcbiAgfSk7XG5cblxuICBmdW5jdGlvbiBoYXJkTW9kZSAoKSB7XG4gICAgJG51bWJlckRpc3BsYXkudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpO1xuICB9XG5cblxuXG5cblxuICBmdW5jdGlvbiB1cGRhdGVQbGF5ZXIgKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyTnVtICUgMiA9PT0gMCkge1xuICAgICAgY3VycmVudFBsYXllciA9ICdQbGF5ZXIgMic7XG4gICAgICAvLyBjb25zb2xlLmxvZyhjdXJyZW50Um91bmQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50UGxheWVyID0gJ1BsYXllciAxJztcbiAgICB9XG4gIH1cblxuXG4gIC8vXG4gIGZ1bmN0aW9uIGVhc3lQbGF5IChrZXkpIHtcbiAgICAkbnVtYmVyRGlzcGxheS5yZW1vdmVDbGFzcygnaGlkZGVuZXInKTtcbiAgICAkbnVtYmVyRGlzcGxheS5odG1sKGtleSk7XG4gICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuXG4gIH1cblxuXG4gIGZ1bmN0aW9uIGhpZGVLZXkoKSB7XG4gICAgJG51bWJlckRpc3BsYXkuYWRkQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gIH1cblxuXG4gIC8vaW5pdGlhbGl6ZXMgdGhlIGJ1aWxkaW5nIG9mIHRoZSBwcm9ncmFtIGFycmF5XG4gIGZ1bmN0aW9uIGdhbWVJbml0ICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRSb3VuZDsgaSsrKXtcbiAgICAgIGNvbnN0IHJhbmQgPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjgpKTtcbiAgICAgIHByb2dyYW1TZXF1ZW5jZS5wdXNoKHZpc3VhbHNbc291bmRzW3JhbmRdXSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKCdpbml0aWFsaXppbmchJyk7XG4gICAgcGxheUJhY2soKTtcbiAgfVxuXG5cbiAgLy8gaGVyZSBkb2VzIHRoZXJlIG5lZWQgdG8gYmUgYSBnYW1lIGFkZCByYW5kb20gYWRkaXRpb24gdG8gYXJyYXkgT1IgYSB3YXkgb2YgdXNpbmcgdGhlIGFib3ZlIGZ1bmN0aW9uIGp1c3QgdG8gYWRkIG9uZT9cblxuICAvL3RoaXMgcGxheXMgYmFjayB0aGUgY29uc3RydWN0ZWQgcHJvZ3JhbSBhcnJheVxuICBsZXQgc2VxdWVuY2VJbmRleCA9IDA7XG5cblxuICBmdW5jdGlvbiBwbGF5QmFjaygpIHtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChzZXF1ZW5jZUluZGV4IDwgY3VycmVudFJvdW5kKSB7XG4gICAgICAgIHBsYXlCYWNrKCk7XG4gICAgICAgIC8vIGVhc3lQbGF5KGtleSk7XG4gICAgICAgIHZpc3VhbGlzZShwcm9ncmFtU2VxdWVuY2Vbc2VxdWVuY2VJbmRleF0pO1xuICAgICAgICAkZmVlZGJhY2suYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2cocHJvZ3JhbVNlcXVlbmNlW3NlcXVlbmNlSW5kZXhdLmF1ZGlvKTtcbiAgICAgICAgc2VxdWVuY2VJbmRleCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VxdWVuY2VJbmRleCA9IDA7XG4gICAgICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSwgMTAwMCk7XG4gIH1cblxuXG5cblxuXG5cblxuICBmdW5jdGlvbiB2aXN1YWxpc2UgKGtleSkge1xuICAgIGF1ZGlvLnNyYyA9IGBzcmMvYXNzZXRzL2F1ZGlvLyR7a2V5LmF1ZGlvfS53YXZgO1xuICAgIGF1ZGlvLnBsYXkoKTtcbiAgICBlYXN5UGxheShrZXkuYXVkaW8pO1xuICAgIGNvbnN0ICRlbGVtZW50ID0ga2V5LmVsZW1lbnQuY2xvbmUoKTtcbiAgICAkZWxlbWVudC5hcHBlbmRUbygnbWFpbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5hZGRDbGFzcyhrZXkuYW5pbWF0aW9uSW4pLnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25PdXQpO1xuICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25JbikuYWRkQ2xhc3Moa2V5LmFuaW1hdGlvbk91dCk7XG4gICAgfSwgMTIwMCk7XG4gICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSwgMTkwMCk7XG5cbiAgfVxuXG4gIC8vRnVuY3Rpb24gcHVzaGVzIGtleSBjaGFyY29kZXMgdGhlIHVzZXIgaW5wdXRzIHRvIHRoZSB1c2VyU2VxdWVuY2UgYXJyYXkuXG4gIC8vIGZ1bmN0aW9uIHVzZXJQdXNoKCkge1xuICAvLyAgIC8vIGlmIChwbGF5aW5nID09PSB0cnVlKSB7XG4gIC8vICAgY29uc29sZS5sb2coJ2xpc3RlbmluZy4uLicpO1xuICAvLyAgIC8vICRkb2N1bWVudC5rZXlwcmVzcyhmdW5jdGlvbihlKSB7XG4gIC8vICAgICB1c2VyU2VxdWVuY2UucHVzaChwYXJzZUludChlLmtleSkpO1xuICAvLyAgICAgLy8gY29uc29sZS5sb2codXNlclNlcXVlbmNlKTtcbiAgLy8gICAgIGNvbXBhcmVBcnJheXMoKTtcbiAgLy8gICB9KTtcblxuICAvLyB9XG5cbiAgLy8gbGlzdGVuKCk7XG5cbiAgbGV0IGxvc3NlcyA9IDA7XG4gIGxldCBjb3VudCAgPSAwO1xuXG5cblxuICAvLyBjb21wYXJlcyB0aGUgdHdvIGFycmF5cyB3aGVuIHRoZSBsZW5ndGggbWF0Y2hlcyB0aGUgY3VycmVudCByb3VuZC5cbiAgLy8gbm90IHN1cGVyIHNpY2ssY291bGRudCBnZXQgaXQgc3RvcCB0cmlnZ2VyaW5nIG9uIGV2ZXJ5IGtleXByZXNzXG4gIC8vIGlmIHBsYXllciBwYXNzZXMgdGVzdCArMSBpcyBhZGRlZCB0byByb3VuZCBsZW5ndGggYW5kIHBsYXliYWNrIHN0YXJ0cyBhZ2Fpbi5cbiAgZnVuY3Rpb24gY29tcGFyZUFycmF5cygpIHtcbiAgICBjb25zdCB0aGVTYW1lID0gdXNlclNlcXVlbmNlLmxlbmd0aCA9PT0gcHJvZ3JhbVNlcXVlbmNlLmxlbmd0aCAmJiB1c2VyU2VxdWVuY2UuZXZlcnkoKHYsaSkgPT4gdiA9PT0gcHJvZ3JhbVNlcXVlbmNlW2ldLmF1ZGlvKTtcbiAgICBjb3VudCArPSAxO1xuICAgIGlmICgoY291bnQgPT09IGN1cnJlbnRSb3VuZCkgJiYgKGxvc3NlcyA9PT0gMCkgJiYgKG1lc3NpbmcgIT09IHRydWUpICYmIChwbGF5aW5nID09PSB0cnVlKSkge1xuICAgICAgY29uc29sZS5sb2codGhlU2FtZSk7XG4gICAgICBpZiAodGhlU2FtZSA9PT0gdHJ1ZSkge1xuICAgICAgICBjb25zdCByYW5kID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSo4KSk7XG4gICAgICAgIHByb2dyYW1TZXF1ZW5jZS5wdXNoKHZpc3VhbHNbc291bmRzW3JhbmRdXSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2dyYW1TZXF1ZW5jZSk7XG4gICAgICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgICAgICBjb3VudCA9IDA7XG4gICAgICAgIGN1cnJlbnRSb3VuZCArPSAxO1xuICAgICAgICBjdXJyZW50UGxheWVyTnVtICs9IDE7XG4gICAgICAgIHVwZGF0ZVBsYXllcigpO1xuICAgICAgICAkZmVlZGJhY2suaHRtbCgnUGFzcyEgLSBuZXh0IHVwICcgKyBjdXJyZW50UGxheWVyKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgc2V0VGltZW91dChwbGF5QmFjaywgMzAwMCk7XG4gICAgICB9IGVsc2UgaWYgKCh0aGVTYW1lID09PSBmYWxzZSkgJiYgKG1lc3NpbmcgIT09IHRydWUpKSB7XG4gICAgICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgICAgICBjb3VudCA9IDA7XG4gICAgICAgIGxvc3NlcyArPSAxO1xuICAgICAgICBjdXJyZW50UGxheWVyTnVtICs9IDE7XG4gICAgICAgIHNldFRpbWVvdXQocGxheUJhY2ssIDMwMDApO1xuICAgICAgICB1cGRhdGVQbGF5ZXIoKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoJ0ZhaWwhIHN1ZGRlbiBkZWF0aCEhIC1uZXh0IHVwICcgKyBjdXJyZW50UGxheWVyKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuXG5cbiAgICAgICAgLy90aGlzIGJvdHRvbSBwYXJ0IG9mIHRoZSBpZiBlbHNlIGFjdHMgYXMgdGhlIHN1ZGRlbiBkZWF0aCBjYWxjdWxhdG9yIHBvcnRpb24gb2YgdGhlIGdhbWUsIHdvcmtzIG9uIHdoZXRoZXIgYSBsb3NzIHdhcyBzdG9yZWQgaW4gdGhlICdsb3NzZXMnIHZhci5cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChjb3VudCA9PT0gY3VycmVudFJvdW5kKSAmJiAobG9zc2VzICE9PSAwKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpe1xuICAgICAgaWYgKHRoZVNhbWUgPT09IHRydWUpIHtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllciArICcgV2lucyEnKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgfSBlbHNlIGlmICgodGhlU2FtZSA9PT0gZmFsc2UpICYmIChtZXNzaW5nICE9PSB0cnVlKSkge1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyICsgJyBGYWlscyEhIC0tLS0gVElFIScpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAkZW5kR2FtZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgY3VycmVudFJvdW5kID0gMztcbiAgICBjdXJyZW50UGxheWVyTnVtID0gY3VycmVudFJvdW5kO1xuICAgIHByb2dyYW1TZXF1ZW5jZSA9IFtdO1xuICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICBtZXNzaW5nID0gZmFsc2U7XG4gICAgLy8gY29uc29sZS5sb2cocGxheWluZyk7XG4gICAgdXBkYXRlUGxheWVyKCk7XG4gICAgbG9zc2VzID0gMDtcbiAgICBjb3VudCA9IDA7XG4gICAgJGZlZWRiYWNrLmh0bWwoJycpO1xuICAgICR3ZWxjb21lLnNob3coKTtcbiAgICAkZW5kR2FtZS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgJGRvY3VtZW50LnVuYmluZCgna2V5cHJlc3MnLCBrZXlMaXN0ZW5lcik7XG4gIH0pO1xuXG5cbn0pO1xuIl19
