"use strict";$(function(){function e(){M=[],w=[],k=3,T=k,m(),B=0,D=0}function n(e){if(!0===z||!0===x){var n=y[e.key],i=e.key;s(n),M.push(parseInt(e.key)),p.removeClass("hiddener"),p.html(i),setTimeout(t,500),d()}}function i(e){p.removeClass("hiddener"),p.html(e),setTimeout(t,500)}function t(){p.addClass("hiddener")}function a(){for(var e=0;e<k;e++){var n=Math.floor(8*Math.random());w.push(y[I[n]])}console.log("initializing!"),o()}function o(){M=[],setTimeout(function(){P<k?(o(),s(w[P]),C.addClass("hidden"),C.html(b),console.log(w[P].audio),P++):(P=0,M=[])},1e3)}function s(e){r.src="src/assets/audio/"+e.audio+".wav",r.play(),i(e.audio);var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function d(){var e=M.length===w.length&&M.every(function(e,n){return e===w[n].audio});D+=1,D===k&&0===B&&!0!==x&&!0===z?(console.log(e),!0===e?(k+=1,u(),l(),C.html("Pass! - next up "+b),C.removeClass("hidden"),setTimeout(o,3e3)):!1===e&&!0!==x&&(B+=1,l(),setTimeout(o,3e3),C.html("Fail! sudden death!! -next up "+b),C.removeClass("hidden"))):D===k&&0!==B&&!0!==x&&(!0===e?(C.html(b+" Wins!"),C.removeClass("hidden"),g.removeClass("hidden")):!1===e&&!0!==x&&(C.html(b+" Fails!! ---- TIE!"),C.removeClass("hidden"),g.removeClass("hidden")))}function u(){var e=Math.floor(8*Math.random());w.push(y[I[e]])}function l(){M=[],D=0,T+=1,m()}function m(){b=T%2==0?"Player 2":"Player 1"}console.log("JS yo");var h=$(document),r=$("audio")[0],c=$(".welcome"),f=$("#game"),v=$("#playground"),C=$(".feedback"),g=($(".reset"),$(".endgame")),O=$(".switch"),p=$(".numberDisplay"),I=[1,2,3,4,5,6,7,8],y={1:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:1},2:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:2},3:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:3},4:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:4},5:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:5},6:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:6},7:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:7},8:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:8}},k=3,T=k,w=[],M=[],b="player 1",x=!1,z=!1;f.on("click",function(){c.hide(),z=!0,C.removeClass("hidden"),C.html(b),e(),h.keypress(n),setTimeout(a,3e3)}),v.on("click",function(){c.hide(),x=!0,g.removeClass("hidden"),e(),h.keypress(n)}),O.on("change",function(){console.log("checked"),p.toggleClass("hidden")});var P=0,B=0,D=0;g.on("click",function(){z=!1,x=!1,B=0,D=0,C.html(""),c.show(),g.addClass("hidden"),h.unbind("keypress",n)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiYnVpbGRHYW1lIiwidXNlclNlcXVlbmNlIiwicHJvZ3JhbVNlcXVlbmNlIiwiY3VycmVudFJvdW5kIiwiY3VycmVudFBsYXllck51bSIsInVwZGF0ZVBsYXllciIsImxvc3NlcyIsImtleUxpc3RlbmVyIiwiZSIsInBsYXlpbmciLCJtZXNzaW5nIiwia2V5IiwidmlzdWFscyIsInZpc3VhbGlzZSIsInNrZXkiLCJwdXNoIiwicGFyc2VJbnQiLCIkbnVtYmVyRGlzcGxheSIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImh0bWwiLCJoaWRlS2V5IiwiYWRkQ2xhc3MiLCJnYW1lSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJpIiwicGxheUJhY2siLCJzb3VuZHMiLCJyYW5kIiwiJGZlZWRiYWNrIiwic2VxdWVuY2VJbmRleCIsImN1cnJlbnRQbGF5ZXIiLCJhdWRpbyIsIiRlbGVtZW50IiwiZWFzeVBsYXkiLCJlbGVtZW50IiwiY2xvbmUiLCJhbmltYXRpb25JbiIsImFuaW1hdGlvbk91dCIsImNvdW50IiwicmVtb3ZlIiwidGhlU2FtZSIsImxlbmd0aCIsImV2ZXJ5IiwidiIsInJvdW5kQWRkTWF0aCIsInJvdW5kUmVzZXQiLCIkZW5kR2FtZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm9uIiwiZG9jdW1lbnQiLCIkZG9jdW1lbnQiLCIkd2VsY29tZSIsIiRnYW1lIiwiJHBsYXlncm91bmQiLCIkcmVzZXQiLCIxIiwiaGlkZSIsIiRzd2l0Y2giLCJ0b2dnbGVDbGFzcyIsInVuYmluZCIsInNob3ciXSwibWFwcGluZ3MiOiJZQUFBQSxHQUFFLFdBb0dBLFFBQUFDLEtBQ0FDLEtBQ0VBLEtBQ0FDLEVBQUFBLEVBQ0FDLEVBQUFBLEVBQ0FDLElBQ0FDLEVBQUFBLEVBQ0FDLEVBQUFBLEVBSUYsUUFBQUMsR0FBQUMsR0FDQSxJQUFTRCxJQUFURSxJQUF3QixJQUFBQyxFQUFBLENBQ3RCLEdBQUtELEdBQUFBLEVBQURE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LFNBQUEsV0FDQVMsUUFBQXBDLElBQVcsV0FDVEQsRUFBWXNDLFlBQVosV0F1Q0EzQyxJQUFBQSxHQUFXLEVBd0NYYixFQUFNb0MsRUFBK0VGLEVBQVNLLENBbUU5RlMsR0FBQUEsR0FBVVMsUUFBTyxXQVJuQnRELEdBQUEsRUF6UUZDLEdBQUEsRUE0UUlKLEVBQVMsRUFhYmtDLEVBQUEsRUFDQVYsRUFBQVYsS0FBQSxJQVhJbUMsRUFBU1MsT0FDVGhCLEVBQVMxQixTQUFTLFVBQ2xCZ0MsRUFBVVMsT0FBTyxXQUFZeEQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdKUyB5bycpO1xuXG4gIGNvbnN0ICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuICBjb25zdCBhdWRpbyA9ICQoJ2F1ZGlvJylbMF07XG4gIGNvbnN0ICR3ZWxjb21lID0gJCgnLndlbGNvbWUnKTtcbiAgY29uc3QgJGdhbWUgPSAkKCcjZ2FtZScpO1xuICBjb25zdCAkcGxheWdyb3VuZCA9ICQoJyNwbGF5Z3JvdW5kJyk7XG4gIGNvbnN0ICRmZWVkYmFjayA9ICQoJy5mZWVkYmFjaycpO1xuICBjb25zdCAkcmVzZXQgPSAkKCcucmVzZXQnKTtcbiAgY29uc3QgJGVuZEdhbWUgPSAkKCcuZW5kZ2FtZScpO1xuICBjb25zdCAkc3dpdGNoID0gJCgnLnN3aXRjaCcpO1xuICBjb25zdCAkbnVtYmVyRGlzcGxheSA9ICQoJy5udW1iZXJEaXNwbGF5JylcblxuICBjb25zdCBzb3VuZHMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOF07XG4gIGNvbnN0IHZpc3VhbHMgPSB7XG4gICAgMToge1xuICAgICAgZWxlbWVudDogJCgnLmZpcnN0JyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZhZGVJbkRvd25CaWcnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnem9vbU91dCcsXG4gICAgICBhdWRpbzogMVxuICAgIH0sXG4gICAgMjoge1xuICAgICAgZWxlbWVudDogJCgnLnNlY29uZCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICd6b29tSW4nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogMlxuICAgIH0sXG4gICAgMzoge1xuICAgICAgZWxlbWVudDogJCgnLnRoaXJkJyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZsYXNoJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDNcbiAgICB9LFxuICAgIDQ6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5mb3VydGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAncm90YXRlSW4nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAncm90YXRlT3V0JyxcbiAgICAgIGF1ZGlvOiA0XG4gICAgfSxcbiAgICA1OiB7XG4gICAgICBlbGVtZW50OiAkKCcuZmlmdGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmxhc2h0d28nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogNVxuICAgIH0sXG4gICAgNjoge1xuICAgICAgZWxlbWVudDogJCgnLnNpeHRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZhZGVJblVwQmlnJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2xpZ2h0U3BlZWRPdXQnLFxuICAgICAgYXVkaW86IDZcbiAgICB9LFxuICAgIDc6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zZXZlbnRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ3NoYWtlJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDdcbiAgICB9LFxuICAgIDg6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5laWdodGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnc2xpZGVJbkxlZnQnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogOFxuICAgIH1cblxuICB9O1xuXG4gIC8vIGN1cnJlbnQgcm91bmQuIGVtcHR5IHByb2dyYW1TZXF1ZW5jZSBhcnJheSxcbiAgLy9nZXRzIGZpbGxlZCB4MyBhdCBzdGFydCB0aGVuIGlzICsxIHBlciByb3VuZFxuICBsZXQgY3VycmVudFJvdW5kID0gMztcbiAgbGV0IGN1cnJlbnRQbGF5ZXJOdW0gPSBjdXJyZW50Um91bmQ7XG4gIGxldCBwcm9ncmFtU2VxdWVuY2UgPSBbXTtcbiAgbGV0IHVzZXJTZXF1ZW5jZSA9IFtdO1xuICBsZXQgY3VycmVudFBsYXllciA9ICdwbGF5ZXIgMSc7XG5cbiAgLy9QbGF5aW5nL21lc3NpbmcgbW9kZSB2YXJzIGZvciBnYW1lIG9yIHBsYXlncm91bmRcbiAgbGV0IG1lc3NpbmcgPSBmYWxzZTtcbiAgbGV0IHBsYXlpbmcgPSBmYWxzZTtcblxuICAvL2dhbWUgYnV0dG9uIGNsaWNrIGZ1bmN0aW9uLSBzaG93cyBjdXJyZW50IHBsYXllciwgc3dpdGNoZXMgcGxheWluZyB0byB0cnVlIGFuZCAgbGF1bmNoZXMgdGhlIGtleSBsaXN0ZW5lciBhbmQgdGhlIGJ1aWxkZ2FtZSBmdW5jdGlvbi5cbiAgJGdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICR3ZWxjb21lLmhpZGUoKTtcbiAgICBwbGF5aW5nID0gdHJ1ZTtcbiAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIpO1xuICAgIGJ1aWxkR2FtZSgpO1xuICAgICRkb2N1bWVudC5rZXlwcmVzcyhrZXlMaXN0ZW5lcik7XG4gICAgc2V0VGltZW91dChnYW1lSW5pdCwgMzAwMCk7XG4gIH0pO1xuXG4gIC8vcGxheWdyb3VuZCBidXR0b24ga2V5IGxpc3RlbmVyLlxuICAkcGxheWdyb3VuZC5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJHdlbGNvbWUuaGlkZSgpO1xuICAgIG1lc3NpbmcgPSB0cnVlO1xuICAgICRlbmRHYW1lLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICBidWlsZEdhbWUoKTtcbiAgICAkZG9jdW1lbnQua2V5cHJlc3Moa2V5TGlzdGVuZXIpO1xuXG4gIH0pO1xuXG4gIC8vc2V0cyB0aGUgZ2FtZSBib2FyZCB1cCBhcyBpdCBzaG91bGQgYmUgYXQgdGhlIGJlZ2lubmluZyBvZiByb3VuZC0gZXNwZWNpYWxseSBtYXR0ZXJzIGFmdGVyIHRoZSByZXNldCBpcyBwcmVzc2VkLlxuICBmdW5jdGlvbiBidWlsZEdhbWUoKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgcHJvZ3JhbVNlcXVlbmNlID0gW107XG4gICAgY3VycmVudFJvdW5kID0gMztcbiAgICBjdXJyZW50UGxheWVyTnVtID0gY3VycmVudFJvdW5kO1xuICAgIHVwZGF0ZVBsYXllcigpO1xuICAgIGxvc3NlcyA9IDA7XG4gICAgY291bnQgPSAwO1xuICB9XG5cbiAgLy9hY3RpdmF0ZXMgdGhlIGtleSBsaXN0ZW5lciBmdW5jdGlvbiB3aGVuIGNhbGxlZCBhbmQgYXR0YWNoZWQgdG8gdGhlIGRvY3VtZW50IGZyb20gdGhlIGdhbWUvcGxheWdyb3VuZCBidXR0b25zLiB0aGVuIHB1c2hlcyB0aGUga2V5IGNvZGUgKDEtOCkgZG93biB0byB0aGUgdmlzdWFsaXNlIGZ1bmN0aW9uIGFuZCBudW1iZXJEaXNwbGF5IGVsZW1lbnQoZm9yIHRoZSBlYXN5IG1vZGUpLlxuICBmdW5jdGlvbiBrZXlMaXN0ZW5lcihlKSB7XG4gICAgaWYgKChwbGF5aW5nID09PSB0cnVlKSB8fCAobWVzc2luZyA9PT0gdHJ1ZSkpIHtcbiAgICAgIGNvbnN0IGtleSA9IHZpc3VhbHNbZS5rZXldO1xuICAgICAgY29uc3Qgc2tleSA9IGUua2V5O1xuICAgICAgdmlzdWFsaXNlKGtleSk7XG4gICAgICB1c2VyU2VxdWVuY2UucHVzaChwYXJzZUludChlLmtleSkpO1xuICAgICAgJG51bWJlckRpc3BsYXkucmVtb3ZlQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gICAgICAkbnVtYmVyRGlzcGxheS5odG1sKHNrZXkpO1xuICAgICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuICAgICAgY29tcGFyZUFycmF5cygpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGFjdGl2YXRlcyB0aGUgaGFyZCBtb2RlIHdoZW4gYnV0dG9uIGlzIGNoZWNrZWQsIHJlbW92aW5nIHRoZSBsYXJnZSBudW1iZXJzXG4gICRzd2l0Y2gub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnY2hlY2tlZCcpO1xuICAgICRudW1iZXJEaXNwbGF5LnRvZ2dsZUNsYXNzKCdoaWRkZW4nKTtcblxuICB9KTtcblxuXG4gIC8vdGhpcyBmdW5jdGlvbiB0YWtlcyB0aGUga2V5cyBwdXNoZWQgZnJvbSB0aGUgdmlzdWFscyBmdW5jdGlvbiBhbmQgdHJhbnNsYXRlcyB0aGVtIGludG8gdGhlIGVhc3ltb2RlIGxhcmdlIG51bWJlcnMgb24gc2NyZWVuXG4gIGZ1bmN0aW9uIGVhc3lQbGF5IChrZXkpIHtcbiAgICAkbnVtYmVyRGlzcGxheS5yZW1vdmVDbGFzcygnaGlkZGVuZXInKTtcbiAgICAkbnVtYmVyRGlzcGxheS5odG1sKGtleSk7XG4gICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuXG4gIH1cblxuXG4gIC8vaGlkZXMgdGhlIGVhc3kgbnVtcyBhZnRlciB0aGUgdGltZSBkaWN0YXRlZCBpbiB0aGUgZnVuY3Rpb25zIGFib3ZlLlxuICBmdW5jdGlvbiBoaWRlS2V5KCkge1xuICAgICRudW1iZXJEaXNwbGF5LmFkZENsYXNzKCdoaWRkZW5lcicpO1xuICB9XG5cblxuICAvL2luaXRpYWxpemVzIHRoZSBidWlsZGluZyBvZiB0aGUgcHJvZ3JhbSBhcnJheSwgZ2VuZXJhdGVzIGEgbnVtYmVyIGZyb20gMS04IHJhbmRvbWx5IGFuZCAqMyB0byBjcmVhdGUgZmlyc3QgYXJyYXkuXG4gIGZ1bmN0aW9uIGdhbWVJbml0ICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRSb3VuZDsgaSsrKXtcbiAgICAgIGNvbnN0IHJhbmQgPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjgpKTtcbiAgICAgIHByb2dyYW1TZXF1ZW5jZS5wdXNoKHZpc3VhbHNbc291bmRzW3JhbmRdXSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKCdpbml0aWFsaXppbmchJyk7XG4gICAgcGxheUJhY2soKTtcbiAgfVxuXG5cbiAgLy9hbGxvd3MgdGhlIHNlcXVlbmNlIHRvIHJlc3RhcnQgYWZ0ZXIgdGhlIGxhc3Qgcm91bmQsIHN0b3BwaW5nIGl0IGZyb20ganVzdCBwbGF5aW5nIHRoZSBlbmQgbnVtYmVyLlxuXG4gIGxldCBzZXF1ZW5jZUluZGV4ID0gMDtcblxuICAvL3RoaXMgcGxheXMgYmFjayB0aGUgY29uc3RydWN0ZWQgcHJvZ3JhbSBhcnJheSBmcm9tIHN0YXJ0IHRvIGZpbmlzaC4gYWxzbyBoaWRlcyB0aGUgY3VycmVudCBwbGF5ZXIgZmVlZGJhY2suIGFuZCBjb25zb2xlIGxvZ3MgdGhlIHByb2dyYW0gc2VxIGFycmF5IGZvciBjaGVhdGluZy5cbiAgZnVuY3Rpb24gcGxheUJhY2soKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoc2VxdWVuY2VJbmRleCA8IGN1cnJlbnRSb3VuZCkge1xuICAgICAgICBwbGF5QmFjaygpO1xuICAgICAgICB2aXN1YWxpc2UocHJvZ3JhbVNlcXVlbmNlW3NlcXVlbmNlSW5kZXhdKTtcbiAgICAgICAgJGZlZWRiYWNrLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2dyYW1TZXF1ZW5jZVtzZXF1ZW5jZUluZGV4XS5hdWRpbyk7XG4gICAgICAgIHNlcXVlbmNlSW5kZXgrKztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlcXVlbmNlSW5kZXggPSAwO1xuICAgICAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIC8vdGFrZXMgdGhlIGNvZGUgcHVzaGVkIGRvd24gZnJvbSB0aGUga2V5bGlzdGVuZXIgYW5kIHRoZSBwbGF5YmFjayBhbmQgdHJhbnNsYXRlcyBpdCB0byBwbGF5IHRoZSBhdWRpbyBzcmMgYW5kIGFuaW1hdGUgdGhlIGRpdnMgYXQgdGhlIHNhbWUgdGltZS4gY2xvbmVzIHRoZSByZWxldmFudCBkaXYgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGJvZHkgYWxzbywgYWxsb3dpbmcgZm9yIG92ZXJsYXBzLiB0aGVuIGRlbGV0ZXMgaXRzZWxmIGFmdGVyIG5lYXJseSAyIHNlY3MuXG5cbiAgZnVuY3Rpb24gdmlzdWFsaXNlIChrZXkpIHtcbiAgICBhdWRpby5zcmMgPSBgc3JjL2Fzc2V0cy9hdWRpby8ke2tleS5hdWRpb30ud2F2YDtcbiAgICBhdWRpby5wbGF5KCk7XG4gICAgZWFzeVBsYXkoa2V5LmF1ZGlvKTtcbiAgICBjb25zdCAkZWxlbWVudCA9IGtleS5lbGVtZW50LmNsb25lKCk7XG4gICAgJGVsZW1lbnQuYXBwZW5kVG8oJ21haW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYWRkQ2xhc3Moa2V5LmFuaW1hdGlvbkluKS5yZW1vdmVDbGFzcyhrZXkuYW5pbWF0aW9uT3V0KTtcbiAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcyhrZXkuYW5pbWF0aW9uSW4pLmFkZENsYXNzKGtleS5hbmltYXRpb25PdXQpO1xuICAgIH0sIDEyMDApO1xuICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICRlbGVtZW50LnJlbW92ZSgpO1xuICAgIH0sIDE5MDApO1xuXG4gIH1cblxuXG4gIGxldCBsb3NzZXMgPSAwO1xuICBsZXQgY291bnQgID0gMDtcblxuICAvLyBjb21wYXJlcyB0aGUgdHdvIGFycmF5cyB3aGVuIHRoZSBsZW5ndGggbWF0Y2hlcyB0aGUgY3VycmVudCByb3VuZC5cbiAgLy8gaWYgcGxheWVyIHBhc3NlcyB0ZXN0ICsxIGlzIGFkZGVkIHRvIHJvdW5kIGxlbmd0aCBhbmQgcGxheWJhY2sgc3RhcnRzIGFnYWluLlxuXG4gIGZ1bmN0aW9uIGNvbXBhcmVBcnJheXMoKSB7XG4gICAgY29uc3QgdGhlU2FtZSA9IHVzZXJTZXF1ZW5jZS5sZW5ndGggPT09IHByb2dyYW1TZXF1ZW5jZS5sZW5ndGggJiYgdXNlclNlcXVlbmNlLmV2ZXJ5KCh2LGkpID0+IHYgPT09IHByb2dyYW1TZXF1ZW5jZVtpXS5hdWRpbyk7XG4gICAgY291bnQgKz0gMTtcbiAgICBpZiAoKGNvdW50ID09PSBjdXJyZW50Um91bmQpICYmIChsb3NzZXMgPT09IDApICYmIChtZXNzaW5nICE9PSB0cnVlKSAmJiAocGxheWluZyA9PT0gdHJ1ZSkpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoZVNhbWUpO1xuICAgICAgaWYgKHRoZVNhbWUgPT09IHRydWUpIHtcbiAgICAgICAgY3VycmVudFJvdW5kICs9IDE7XG4gICAgICAgIHJvdW5kQWRkTWF0aCgpO1xuICAgICAgICByb3VuZFJlc2V0KCk7XG4gICAgICAgICRmZWVkYmFjay5odG1sKCdQYXNzISAtIG5leHQgdXAgJyArIGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICBzZXRUaW1lb3V0KHBsYXlCYWNrLCAzMDAwKTtcbiAgICAgIH0gZWxzZSBpZiAoKHRoZVNhbWUgPT09IGZhbHNlKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpIHtcbiAgICAgICAgbG9zc2VzICs9IDE7XG4gICAgICAgIHJvdW5kUmVzZXQoKTtcbiAgICAgICAgc2V0VGltZW91dChwbGF5QmFjaywgMzAwMCk7XG4gICAgICAgICRmZWVkYmFjay5odG1sKCdGYWlsISBzdWRkZW4gZGVhdGghISAtbmV4dCB1cCAnICsgY3VycmVudFBsYXllcik7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cblxuICAgICAgICAvL3RoaXMgYm90dG9tIHBhcnQgb2YgdGhlIGlmIGVsc2UgYWN0cyBhcyB0aGUgc3VkZGVuIGRlYXRoIGNhbGN1bGF0b3IgcG9ydGlvbiBvZiB0aGUgZ2FtZSwgd29ya3Mgb24gd2hldGhlciBhIGxvc3Mgd2FzIHN0b3JlZCBpbiB0aGUgJ2xvc3NlcycgdmFyLlxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoKGNvdW50ID09PSBjdXJyZW50Um91bmQpICYmIChsb3NzZXMgIT09IDApICYmIChtZXNzaW5nICE9PSB0cnVlKSl7XG4gICAgICBpZiAodGhlU2FtZSA9PT0gdHJ1ZSkge1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyICsgJyBXaW5zIScpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICB9IGVsc2UgaWYgKCh0aGVTYW1lID09PSBmYWxzZSkgJiYgKG1lc3NpbmcgIT09IHRydWUpKSB7XG4gICAgICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIgKyAnIEZhaWxzISEgLS0tLSBUSUUhJyk7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRlbmRHYW1lLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdGhlIGNvbXBhcmUgYXJyYXlzIGZ1bmN0aW9uIGFuZCB1cHMgdGhlIHByb2dyYW0gYXJyYXkgYnkgMSByYW5kb21seSBnZW5lcmF0ZWQgbnVtYmVyLlxuICBmdW5jdGlvbiByb3VuZEFkZE1hdGggKCkge1xuICAgIGNvbnN0IHJhbmQgPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjgpKTtcbiAgICBwcm9ncmFtU2VxdWVuY2UucHVzaCh2aXN1YWxzW3NvdW5kc1tyYW5kXV0pO1xuICB9XG5cblxuICAvLyB0aGlzIHJlc2V0cyB0aGUgcm91bmQgYWZ0ZXIgYSBmaXJzdCB0aW1lIHdpbiBvciBmYWlsLCBhbGxvd2luZyBmb3IgdGhlIGN1cnJlbnQgcGxheWVyIHRvIGNoYW5nZSBidXQgbm90IHRoZSByb3VuZCBudW1iZXIgZm9yIHN1ZGRlbiBkZWF0aC5cbiAgZnVuY3Rpb24gcm91bmRSZXNldCAoKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgY291bnQgPSAwO1xuICAgIGN1cnJlbnRQbGF5ZXJOdW0gKz0gMTtcbiAgICB1cGRhdGVQbGF5ZXIoKTtcbiAgfVxuXG4gIC8vdXBkYXRlcyB0aGUgY3VycmVudCBwbGF5ZXIgYXMgdGhlIHJvdW5kcyBpbmNyZWFzZS0gaGFzIHRvIGJlIGN1cnJlbnQgcGxheWVyIG51bSBkdWUgdG8gdGhlIGN1cnJlbnQgcGxheWVyIG5lZWRpbmcgdG8gdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSB0aGUgY3VycmVudCByb3VuZCBmb3IgdGhlIHN1ZGRlbiBkZWF0aCByb3VuZFxuICBmdW5jdGlvbiB1cGRhdGVQbGF5ZXIgKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyTnVtICUgMiA9PT0gMCkge1xuICAgICAgY3VycmVudFBsYXllciA9ICdQbGF5ZXIgMic7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSAnUGxheWVyIDEnO1xuICAgIH1cbiAgfVxuICBcbiAgJGVuZEdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICBtZXNzaW5nID0gZmFsc2U7XG4gICAgbG9zc2VzID0gMDtcbiAgICBjb3VudCA9IDA7XG4gICAgJGZlZWRiYWNrLmh0bWwoJycpO1xuICAgICR3ZWxjb21lLnNob3coKTtcbiAgICAkZW5kR2FtZS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgJGRvY3VtZW50LnVuYmluZCgna2V5cHJlc3MnLCBrZXlMaXN0ZW5lcik7XG4gIH0pO1xuXG5cbn0pO1xuXG5cblxuLy90byBkbyAtIG1ha2UgdGhlIGtleSBsaXN0ZW4gb25seSB3b3JrIG9uY2UgdGhlIGtleSBoYXMgcGxheWVkIGJhY2tcbi8vbWFzc2l2ZWx5IHJlZHVjZSB0aGUgY29tcGFyZSBhcnJheXMgZnVuY3Rpb24sIG1heWJlIG1vdmUgYWRkIG1hdGggb3V0LlxuIl19
