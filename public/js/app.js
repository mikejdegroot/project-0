"use strict";$(function(){function e(){b=[],w=[],k=3,T=k,m(),B=0,D=0}function n(e){if((z||x)&&I[e.key]){var n=I[e.key],i=e.key;s(n),b.push(parseInt(e.key)),O.removeClass("hiddener"),O.html(i),setTimeout(t,500),d()}}function i(e){O.removeClass("hiddener"),O.html(e),setTimeout(t,500)}function t(){O.addClass("hiddener")}function a(){for(var e=0;e<k;e++){var n=Math.floor(8*Math.random());w.push(I[y[n]])}console.log("initializing!"),o()}function o(){b=[],setTimeout(function(){P<k?(o(),s(w[P]),p.addClass("hidden"),p.html(M),console.log(w[P].audio),P++):(P=0,b=[],r.keypress(n))},1e3)}function s(e){h.src="src/assets/audio/"+e.audio+".wav",h.play(),i(e.audio);var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function d(){var e=b.length===w.length&&b.every(function(e,n){return e===w[n].audio});D+=1,D===k&&0===B&&!0!==x&&!0===z?(console.log(e),e?(k+=1,u(),l(),p.html("Pass! - next up "+M),p.removeClass("hidden"),r.unbind("keypress",n),setTimeout(o,3e3)):e||x||(B+=1,l(),r.unbind("keypress",n),setTimeout(o,3e3),p.html("Fail! sudden death!! -next up "+M),p.removeClass("hidden"))):D!==k||0===B||x||(!0===e?(p.html(M+" Wins!"),p.removeClass("hidden"),C.removeClass("hidden")):e||x||(p.html(M+" Fails!! ---- TIE!"),p.removeClass("hidden"),C.removeClass("hidden")))}function u(){var e=Math.floor(8*Math.random());w.push(I[y[e]])}function l(){b=[],D=0,T+=1,m()}function m(){M=T%2==0?"Player 2":"Player 1"}console.log("JS yo");var r=$(document),h=$("audio")[0],c=$(".welcome"),f=$("#game"),v=$("#playground"),p=$(".feedback"),C=($(".reset"),$(".endgame")),g=$(".switch"),O=$(".numberDisplay"),y=[1,2,3,4,5,6,7,8],I={1:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:1},2:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:2},3:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:3},4:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:4},5:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:5},6:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:6},7:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:7},8:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:8}},k=3,T=k,w=[],b=[],M="player 1",x=!1,z=!1;f.on("click",function(){c.hide(),z=!0,p.removeClass("hidden"),p.html(M),e(),setTimeout(a,3e3)}),v.on("click",function(){c.hide(),x=!0,C.removeClass("hidden"),e(),r.keypress(n)}),g.on("change",function(){console.log("checked"),O.toggleClass("hidden")});var P=0,B=0,D=0;C.on("click",function(){z=!1,x=!1,B=0,D=0,p.html(""),c.show(),C.addClass("hidden"),r.unbind("keypress",n)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiYnVpbGRHYW1lIiwidXNlclNlcXVlbmNlIiwicHJvZ3JhbVNlcXVlbmNlIiwiY3VycmVudFJvdW5kIiwiY3VycmVudFBsYXllck51bSIsInVwZGF0ZVBsYXllciIsImxvc3NlcyIsImtleUxpc3RlbmVyIiwiZSIsInBsYXlpbmciLCJ2aXN1YWxzIiwia2V5IiwibWVzc2luZyIsInZpc3VhbGlzZSIsInNrZXkiLCJwdXNoIiwicGFyc2VJbnQiLCIkbnVtYmVyRGlzcGxheSIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImh0bWwiLCJoaWRlS2V5IiwiYWRkQ2xhc3MiLCJnYW1lSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJpIiwicGxheUJhY2siLCJzb3VuZHMiLCJyYW5kIiwiJGZlZWRiYWNrIiwic2VxdWVuY2VJbmRleCIsImN1cnJlbnRQbGF5ZXIiLCIkZG9jdW1lbnQiLCJrZXlwcmVzcyIsImF1ZGlvIiwiJGVsZW1lbnQiLCJlYXN5UGxheSIsImVsZW1lbnQiLCJjbG9uZSIsImFuaW1hdGlvbkluIiwiYW5pbWF0aW9uT3V0IiwiY291bnQiLCJyZW1vdmUiLCJ0aGVTYW1lIiwibGVuZ3RoIiwiZXZlcnkiLCJ2Iiwicm91bmRBZGRNYXRoIiwicm91bmRSZXNldCIsInVuYmluZCIsIiRlbmRHYW1lIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwib24iLCJkb2N1bWVudCIsIiR3ZWxjb21lIiwiJGdhbWUiLCIkcGxheWdyb3VuZCIsIiRyZXNldCIsIjEiLCJoaWRlIiwiJHN3aXRjaCIsInRvZ2dsZUNsYXNzIiwic2hvdyJdLCJtYXBwaW5ncyI6IllBQUFBLEdBQUUsV0FvR0EsUUFBQUMsS0FDQUMsS0FDRUEsS0FDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFDQUMsSUFDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFJRixRQUFBQyxHQUFBQyxHQUNBLElBQUFDLEdBQVNGLElBQWVHLEVBQUFGLEVBQUFHLEtBQUEsQ0FDdEIsR0FBS0YsR0FBQUEsRUFBV0csRUFBWkQsS0FDSUEsRUFBTUQsRUFBQUEsR0FDWkcsR0FBTUMsR0FDTkQsRUFBQUUsS0FBQUMsU0FBQVIsRUFBQUcsTUFDQVYsRUFBYWMsWUFBY1AsWUFDM0JTLEVBQWVDLEtBQUFBLEdBQ2ZELFdBQUFBLEVBQW9CSCxLQUNwQkssS0FlRkYsUUFBQUEsR0FBZUMsR0FDZkQsRUFBZUcsWUFBZixZQUNBRCxFQUFXRSxLQUFTVixHQUVyQlEsV0FBQUUsRUFBQSxLQUlELFFBQVNBLEtBS1RKLEVBQUFLLFNBQUEsWUFLRyxRQUFBQyxLQUNEQyxJQUFBQSxHQUFRQyxHQUFJLEVBQUFDLEVBQUF2QixFQUFadUIsSUFBQSxDQUNBQyxHQUFBQSxHQUFBQSxLQUFBQSxNQUFBQSxFQUFBQSxLQUFBQSxTQUNEekIsR0FBQWEsS0FBQUwsRUFBQWtCLEVBQUFDLEtBR0RMLFFBQUFDLElBQUEsaUJBSkVFLElBY0lkLFFBQUFBLEtBQ0FpQixLQUNBQSxXQUFBQSxXQUNBTixFQUFZdEIsR0FDWjZCLElBTkZsQixFQU9PWCxFQUFBNkIsSUFDTEEsRUFBQUEsU0FBQSxVQUNBOUIsRUFBQUEsS0FBZStCLEdBQ2ZDLFFBQUFBLElBQVVDLEVBQVMzQixHQUFuQjRCLE9BQ0RKLE1BRUpBLEVBQUEsRUFKSzlCLEtBTU5nQyxFQUFBQyxTQUFBM0IsS0FFQSxLQUtFNkIsUUFBQUEsR0FBa0J6QixHQUNsQlEsRUFBQUEsSUFBQUEsb0JBQWtCUixFQUFBd0IsTUFBbEJoQixPQUNFaUIsRUFBQUEsT0FDREMsRUFGRDFCLEVBQUF3QixNQUdBaEIsSUFBQUEsR0FBWVIsRUFBQTJCLFFBQU1DLE9BQ2hCSCxHQUFBQSxTQUFBLFFBQUFsQixZQUFBLFVBQUFJLFNBQUFYLEVBQUE2QixhQUFBdEIsWUFBQVAsRUFBQThCLGNBQ0R0QixXQUZELFdBSURpQixFQUFBbEIsWUFBQVAsRUFBQTZCLGFBQUFsQixTQUFBWCxFQUFBOEIsZUFMSSxNQVFMdEIsV0FBQSxXQUNJdUIsRUFBSkMsVUFOSyxNQWdCRCxRQUFJQyxLQUNGekMsR0FBQUEsR0FBQUEsRUFBQTBDLFNBQUEzQyxFQUFBMkMsUUFBQTVDLEVBQUE2QyxNQUFBLFNBQUFDLEVBQUFyQixHQUFBLE1BQUFxQixLQUFBN0MsRUFBQXdCLEdBQUFTLE9BQ0FhLElBQUFBLEVBQ0FDLElBQUFBLEdBQUFBLElBQUFBLElBQUFBLElBQUFBLElBQUFBLElBQUFBLEdBQ0FuQixRQUFBQSxJQUFVVixHQUNWVSxHQUNBRyxHQUFBLEVBQ0FkLElBUEY4QixJQVNFM0MsRUFBVWMsS0FBVixtQkFBQVksR0FDQWlCLEVBQUFBLFlBQUFBLFVBQ0FoQixFQUFVaUIsT0FBTyxXQUFZM0MsR0FDN0JZLFdBQVdRLEVBQVUsTUFDWFAsR0FBS1IsSUFDZmtCLEdBQVVaLEVBSlYrQixJQU9BaEIsRUFBQWlCLE9BQUEsV0FBQTNDLEdBQ0RZLFdBQUFRLEVBQUEsS0FwQkhHLEVBcUJXWSxLQUFBQSxpQ0FBMkM5QixHQUNwRGtCLEVBQUljLFlBQWtCLFlBS3BCZCxJQUFlRSxHQUFnQixJQUFBMUIsR0FBQU0sS0FDckJNLElBQVZZLEdBQ0FxQixFQUFTakMsS0FBQUEsRUFBVCxVQUVEWSxFQUFBWixZQUFBLFVBQ0ZpQyxFQUFBakMsWUFBQSxXQUNGMEIsR0FBQWhDLElBTktrQixFQUFVVixLQUFLWSxFQUFnQixzQkFRckNGLEVBQUFaLFlBQUEsVUFDQWlDLEVBQVNILFlBQWdCLFlBUXZCL0MsUUFBQUEsS0FDQXlDLEdBQUFBLEdBQUFVLEtBQUFDLE1BQUEsRUFBQUQsS0FBQUUsU0FDQWxELEdBQUFBLEtBQUFNLEVBQUFrQixFQUFBQyxLQUtGLFFBQVN4QixLQUNQSixLQUNFK0IsRUFBQUEsRUFDRDVCLEdBQU0sRUFDTDRCLElBSUptQixRQUFTSSxLQUVQM0MsRUFEQUgsRUFBQSxHQUFBLEVBQ0EsV0FFQSxXQS9RRmUsUUFBUUMsSUFBSSxRQUFaRCxJQUFBQSxHQUFZekIsRUFBWnlELFVBR01yQixFQUFRcEMsRUFBRSxTQUFTLEdBRG5Ca0MsRUFBWWxDLEVBQUV5RCxZQUNkckIsRUFBVXBDLEVBQUEsU0FDVjBELEVBQWExRCxFQUFBLGVBQ2IyRCxFQUFVM0QsRUFBQSxhQUVWK0IsR0FEQTZCLEVBQUFBLFVBQ1k1RCxFQUFFLGFBQ2Q2RCxFQUFXN0QsRUFBQSxXQUNYb0QsRUFBYXBELEVBQUEsa0JBRWJrQixHQUFBQSxFQUFBQSxFQUFpQmxCLEVBQUUsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUduQlcsR0FETm1ELEdBQ01uRCxRQUFBQSxFQUFVLFVBQ2Q4QixZQUFHLGdCQUNERixhQUFXLFVBQ1hFLE1BQUFBLEdBRUFMLEdBTFlHLFFBQUF2QyxFQUFBLFdBT2R5QyxZQUFHLFNBQ0RGLGFBQVcsVUFDWEUsTUFBQUEsR0FFQUwsR0FYWUcsUUFBQXZDLEVBQUEsVUFhZHlDLFlBQUcsUUFDREYsYUFBVyxVQUNYRSxNQUFBQSxHQUVBTCxHQWpCWUcsUUFBQXZDLEVBQUEsV0FtQmR5QyxZQUFHLFdBQ0RGLGFBQVcsWUFDWEUsTUFBQUEsR0FFQUwsR0F2QllHLFFBQUF2QyxFQUFBLFVBeUJkeUMsWUFBRyxXQUNERixhQUFXLFVBQ1hFLE1BQUFBLEdBRUFMLEdBN0JZRyxRQUFBdkMsRUFBQSxVQStCZHlDLFlBQUcsY0FDREYsYUFBVyxnQkFDWEUsTUFBQUEsR0FFQUwsR0FuQ1lHLFFBQUF2QyxFQUFBLFlBcUNkeUMsWUFBRyxRQUNERixhQUFXLFVBQ1hFLE1BQUFBLEdBRUFMLEdBekNZRyxRQUFBdkMsRUFBQSxXQTJDZHlDLFlBQUcsY0FDREYsYUFBVyxVQUNYRSxNQUFBQSxJQU9KckMsRUFBQSxFQUNBQyxFQUFBRCxFQUNJQSxLQUNBQyxLQUNBRixFQUFBQSxXQUtBVSxHQUFVLEVBRGRILEdBQUEsQ0FLQWlELEdBQU1ILEdBQUcsUUFBUyxXQURsQkUsRUFBQUssT0FDQUosR0FBUyxFQUNQRCxFQUFTSyxZQUFULFVBQ0FyRCxFQUFVVyxLQUFWWSxHQUNBRixJQUVBOUIsV0FBQUEsRUFBQUEsT0FNRjJELEVBQVlKLEdBQUcsUUFBUyxXQUR4QkUsRUFBQUssT0FDQUgsR0FBWUosRUFDVkUsRUFBU0ssWUFBVCxVQUNBbEQsSUFDQXVDLEVBQVNqQyxTQUFBQSxLQStCWDZDLEVBQUFSLEdBQUEsU0FBQSxXQUNBUSxRQUFBdEMsSUFBVyxXQUNURCxFQUFZd0MsWUFBWixXQXVDQTdDLElBQUFBLEdBQVcsRUF5Q1hiLEVBQU1zQyxFQUErRUYsRUFBU0ssQ0FxRTlGZCxHQUFBQSxHQUFVaUIsUUFBTyxXQVJuQnpDLEdBQUEsRUE1UUZHLEdBQUEsRUErUUlOLEVBQVMsRUFhYm9DLEVBQUEsRUFDQVosRUFBQVYsS0FBQSxJQVhJcUMsRUFBU1EsT0FDVGQsRUFBUzdCLFNBQVMsVUFDbEJXLEVBQVVpQixPQUFPLFdBQVkzQyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKCgpID0+IHtcbiAgY29uc29sZS5sb2coJ0pTIHlvJyk7XG5cbiAgY29uc3QgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7XG4gIGNvbnN0IGF1ZGlvID0gJCgnYXVkaW8nKVswXTtcbiAgY29uc3QgJHdlbGNvbWUgPSAkKCcud2VsY29tZScpO1xuICBjb25zdCAkZ2FtZSA9ICQoJyNnYW1lJyk7XG4gIGNvbnN0ICRwbGF5Z3JvdW5kID0gJCgnI3BsYXlncm91bmQnKTtcbiAgY29uc3QgJGZlZWRiYWNrID0gJCgnLmZlZWRiYWNrJyk7XG4gIGNvbnN0ICRyZXNldCA9ICQoJy5yZXNldCcpO1xuICBjb25zdCAkZW5kR2FtZSA9ICQoJy5lbmRnYW1lJyk7XG4gIGNvbnN0ICRzd2l0Y2ggPSAkKCcuc3dpdGNoJyk7XG4gIGNvbnN0ICRudW1iZXJEaXNwbGF5ID0gJCgnLm51bWJlckRpc3BsYXknKVxuXG4gIGNvbnN0IHNvdW5kcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4XTtcbiAgY29uc3QgdmlzdWFscyA9IHtcbiAgICAxOiB7XG4gICAgICBlbGVtZW50OiAkKCcuZmlyc3QnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmFkZUluRG93bkJpZycsXG4gICAgICBhbmltYXRpb25PdXQ6ICd6b29tT3V0JyxcbiAgICAgIGF1ZGlvOiAxXG4gICAgfSxcbiAgICAyOiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2Vjb25kJyksXG4gICAgICBhbmltYXRpb25JbjogJ3pvb21JbicsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiAyXG4gICAgfSxcbiAgICAzOiB7XG4gICAgICBlbGVtZW50OiAkKCcudGhpcmQnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmxhc2gnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogM1xuICAgIH0sXG4gICAgNDoge1xuICAgICAgZWxlbWVudDogJCgnLmZvdXJ0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdyb3RhdGVJbicsXG4gICAgICBhbmltYXRpb25PdXQ6ICdyb3RhdGVPdXQnLFxuICAgICAgYXVkaW86IDRcbiAgICB9LFxuICAgIDU6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5maWZ0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmbGFzaHR3bycsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1XG4gICAgfSxcbiAgICA2OiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2l4dGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmFkZUluVXBCaWcnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnbGlnaHRTcGVlZE91dCcsXG4gICAgICBhdWRpbzogNlxuICAgIH0sXG4gICAgNzoge1xuICAgICAgZWxlbWVudDogJCgnLnNldmVudGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnc2hha2UnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogN1xuICAgIH0sXG4gICAgODoge1xuICAgICAgZWxlbWVudDogJCgnLmVpZ2h0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdzbGlkZUluTGVmdCcsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA4XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gY3VycmVudCByb3VuZC4gZW1wdHkgcHJvZ3JhbVNlcXVlbmNlIGFycmF5LFxuICAvL2dldHMgZmlsbGVkIHgzIGF0IHN0YXJ0IHRoZW4gaXMgKzEgcGVyIHJvdW5kXG4gIGxldCBjdXJyZW50Um91bmQgPSAzO1xuICBsZXQgY3VycmVudFBsYXllck51bSA9IGN1cnJlbnRSb3VuZDtcbiAgbGV0IHByb2dyYW1TZXF1ZW5jZSA9IFtdO1xuICBsZXQgdXNlclNlcXVlbmNlID0gW107XG4gIGxldCBjdXJyZW50UGxheWVyID0gJ3BsYXllciAxJztcblxuICAvL1BsYXlpbmcvbWVzc2luZyBtb2RlIHZhcnMgZm9yIGdhbWUgb3IgcGxheWdyb3VuZFxuICBsZXQgbWVzc2luZyA9IGZhbHNlO1xuICBsZXQgcGxheWluZyA9IGZhbHNlO1xuXG4gIC8vZ2FtZSBidXR0b24gY2xpY2sgZnVuY3Rpb24tIHNob3dzIGN1cnJlbnQgcGxheWVyLCBzd2l0Y2hlcyBwbGF5aW5nIHRvIHRydWUgYW5kICBsYXVuY2hlcyB0aGUga2V5IGxpc3RlbmVyIGFuZCB0aGUgYnVpbGRnYW1lIGZ1bmN0aW9uLlxuICAkZ2FtZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJHdlbGNvbWUuaGlkZSgpO1xuICAgIHBsYXlpbmcgPSB0cnVlO1xuICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgYnVpbGRHYW1lKCk7XG4gICAgLy8gJGRvY3VtZW50LmtleXByZXNzKGtleUxpc3RlbmVyKTtcbiAgICBzZXRUaW1lb3V0KGdhbWVJbml0LCAzMDAwKTtcbiAgfSk7XG5cbiAgLy9wbGF5Z3JvdW5kIGJ1dHRvbiBrZXkgbGlzdGVuZXIuXG4gICRwbGF5Z3JvdW5kLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAkd2VsY29tZS5oaWRlKCk7XG4gICAgbWVzc2luZyA9IHRydWU7XG4gICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgIGJ1aWxkR2FtZSgpO1xuICAgICRkb2N1bWVudC5rZXlwcmVzcyhrZXlMaXN0ZW5lcik7XG5cbiAgfSk7XG5cbiAgLy9zZXRzIHRoZSBnYW1lIGJvYXJkIHVwIGFzIGl0IHNob3VsZCBiZSBhdCB0aGUgYmVnaW5uaW5nIG9mIHJvdW5kLSBlc3BlY2lhbGx5IG1hdHRlcnMgYWZ0ZXIgdGhlIHJlc2V0IGlzIHByZXNzZWQuXG4gIGZ1bmN0aW9uIGJ1aWxkR2FtZSgpIHtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBwcm9ncmFtU2VxdWVuY2UgPSBbXTtcbiAgICBjdXJyZW50Um91bmQgPSAzO1xuICAgIGN1cnJlbnRQbGF5ZXJOdW0gPSBjdXJyZW50Um91bmQ7XG4gICAgdXBkYXRlUGxheWVyKCk7XG4gICAgbG9zc2VzID0gMDtcbiAgICBjb3VudCA9IDA7XG4gIH1cblxuICAvL2FjdGl2YXRlcyB0aGUga2V5IGxpc3RlbmVyIGZ1bmN0aW9uIHdoZW4gY2FsbGVkIGFuZCBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQgZnJvbSB0aGUgZ2FtZS9wbGF5Z3JvdW5kIGJ1dHRvbnMuIHRoZW4gcHVzaGVzIHRoZSBrZXkgY29kZSAoMS04KSBkb3duIHRvIHRoZSB2aXN1YWxpc2UgZnVuY3Rpb24gYW5kIG51bWJlckRpc3BsYXkgZWxlbWVudChmb3IgdGhlIGVhc3kgbW9kZSkuXG4gIGZ1bmN0aW9uIGtleUxpc3RlbmVyKGUpIHtcbiAgICBpZiAoKHBsYXlpbmcgfHwgbWVzc2luZykgJiYgdmlzdWFsc1tlLmtleV0pIHtcbiAgICAgIGNvbnN0IGtleSA9IHZpc3VhbHNbZS5rZXldO1xuICAgICAgY29uc3Qgc2tleSA9IGUua2V5O1xuICAgICAgdmlzdWFsaXNlKGtleSk7XG4gICAgICB1c2VyU2VxdWVuY2UucHVzaChwYXJzZUludChlLmtleSkpO1xuICAgICAgJG51bWJlckRpc3BsYXkucmVtb3ZlQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gICAgICAkbnVtYmVyRGlzcGxheS5odG1sKHNrZXkpO1xuICAgICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuICAgICAgY29tcGFyZUFycmF5cygpO1xuICAgIH1cbiAgfVxuXG4gIC8vIGFjdGl2YXRlcyB0aGUgaGFyZCBtb2RlIHdoZW4gYnV0dG9uIGlzIGNoZWNrZWQsIHJlbW92aW5nIHRoZSBsYXJnZSBudW1iZXJzXG4gICRzd2l0Y2gub24oJ2NoYW5nZScsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnY2hlY2tlZCcpO1xuICAgICRudW1iZXJEaXNwbGF5LnRvZ2dsZUNsYXNzKCdoaWRkZW4nKTtcblxuICB9KTtcblxuXG4gIC8vdGhpcyBmdW5jdGlvbiB0YWtlcyB0aGUga2V5cyBwdXNoZWQgZnJvbSB0aGUgdmlzdWFscyBmdW5jdGlvbiBhbmQgdHJhbnNsYXRlcyB0aGVtIGludG8gdGhlIGVhc3ltb2RlIGxhcmdlIG51bWJlcnMgb24gc2NyZWVuXG4gIGZ1bmN0aW9uIGVhc3lQbGF5IChrZXkpIHtcbiAgICAkbnVtYmVyRGlzcGxheS5yZW1vdmVDbGFzcygnaGlkZGVuZXInKTtcbiAgICAkbnVtYmVyRGlzcGxheS5odG1sKGtleSk7XG4gICAgc2V0VGltZW91dChoaWRlS2V5LCA1MDApO1xuXG4gIH1cblxuXG4gIC8vaGlkZXMgdGhlIGVhc3kgbnVtcyBhZnRlciB0aGUgdGltZSBkaWN0YXRlZCBpbiB0aGUgZnVuY3Rpb25zIGFib3ZlLlxuICBmdW5jdGlvbiBoaWRlS2V5KCkge1xuICAgICRudW1iZXJEaXNwbGF5LmFkZENsYXNzKCdoaWRkZW5lcicpO1xuICB9XG5cblxuICAvL2luaXRpYWxpemVzIHRoZSBidWlsZGluZyBvZiB0aGUgcHJvZ3JhbSBhcnJheSwgZ2VuZXJhdGVzIGEgbnVtYmVyIGZyb20gMS04IHJhbmRvbWx5IGFuZCAqMyB0byBjcmVhdGUgZmlyc3QgYXJyYXkuXG4gIGZ1bmN0aW9uIGdhbWVJbml0ICgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRSb3VuZDsgaSsrKXtcbiAgICAgIGNvbnN0IHJhbmQgPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjgpKTtcbiAgICAgIHByb2dyYW1TZXF1ZW5jZS5wdXNoKHZpc3VhbHNbc291bmRzW3JhbmRdXSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKCdpbml0aWFsaXppbmchJyk7XG4gICAgcGxheUJhY2soKTtcbiAgfVxuXG5cbiAgLy9hbGxvd3MgdGhlIHNlcXVlbmNlIHRvIHJlc3RhcnQgYWZ0ZXIgdGhlIGxhc3Qgcm91bmQsIHN0b3BwaW5nIGl0IGZyb20ganVzdCBwbGF5aW5nIHRoZSBlbmQgbnVtYmVyLlxuXG4gIGxldCBzZXF1ZW5jZUluZGV4ID0gMDtcblxuICAvL3RoaXMgcGxheXMgYmFjayB0aGUgY29uc3RydWN0ZWQgcHJvZ3JhbSBhcnJheSBmcm9tIHN0YXJ0IHRvIGZpbmlzaC4gYWxzbyBoaWRlcyB0aGUgY3VycmVudCBwbGF5ZXIgZmVlZGJhY2suIGFuZCBjb25zb2xlIGxvZ3MgdGhlIHByb2dyYW0gc2VxIGFycmF5IGZvciBjaGVhdGluZy5cbiAgZnVuY3Rpb24gcGxheUJhY2soKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoc2VxdWVuY2VJbmRleCA8IGN1cnJlbnRSb3VuZCkge1xuICAgICAgICBwbGF5QmFjaygpO1xuICAgICAgICB2aXN1YWxpc2UocHJvZ3JhbVNlcXVlbmNlW3NlcXVlbmNlSW5kZXhdKTtcbiAgICAgICAgJGZlZWRiYWNrLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2dyYW1TZXF1ZW5jZVtzZXF1ZW5jZUluZGV4XS5hdWRpbyk7XG4gICAgICAgIHNlcXVlbmNlSW5kZXgrKztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlcXVlbmNlSW5kZXggPSAwO1xuICAgICAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICAgICAgJGRvY3VtZW50LmtleXByZXNzKGtleUxpc3RlbmVyKTtcbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIC8vdGFrZXMgdGhlIGNvZGUgcHVzaGVkIGRvd24gZnJvbSB0aGUga2V5bGlzdGVuZXIgYW5kIHRoZSBwbGF5YmFjayBhbmQgdHJhbnNsYXRlcyBpdCB0byBwbGF5IHRoZSBhdWRpbyBzcmMgYW5kIGFuaW1hdGUgdGhlIGRpdnMgYXQgdGhlIHNhbWUgdGltZS4gY2xvbmVzIHRoZSByZWxldmFudCBkaXYgYW5kIGFwcGVuZHMgaXQgdG8gdGhlIGJvZHkgYWxzbywgYWxsb3dpbmcgZm9yIG92ZXJsYXBzLiB0aGVuIGRlbGV0ZXMgaXRzZWxmIGFmdGVyIG5lYXJseSAyIHNlY3MuXG5cbiAgZnVuY3Rpb24gdmlzdWFsaXNlIChrZXkpIHtcbiAgICBhdWRpby5zcmMgPSBgc3JjL2Fzc2V0cy9hdWRpby8ke2tleS5hdWRpb30ud2F2YDtcbiAgICBhdWRpby5wbGF5KCk7XG4gICAgZWFzeVBsYXkoa2V5LmF1ZGlvKTtcbiAgICBjb25zdCAkZWxlbWVudCA9IGtleS5lbGVtZW50LmNsb25lKCk7XG4gICAgJGVsZW1lbnQuYXBwZW5kVG8oJ21haW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYWRkQ2xhc3Moa2V5LmFuaW1hdGlvbkluKS5yZW1vdmVDbGFzcyhrZXkuYW5pbWF0aW9uT3V0KTtcbiAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XG4gICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcyhrZXkuYW5pbWF0aW9uSW4pLmFkZENsYXNzKGtleS5hbmltYXRpb25PdXQpO1xuICAgIH0sIDEyMDApO1xuICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICRlbGVtZW50LnJlbW92ZSgpO1xuICAgIH0sIDE5MDApO1xuXG4gIH1cblxuXG4gIGxldCBsb3NzZXMgPSAwO1xuICBsZXQgY291bnQgID0gMDtcblxuICAvLyBjb21wYXJlcyB0aGUgdHdvIGFycmF5cyB3aGVuIHRoZSBsZW5ndGggbWF0Y2hlcyB0aGUgY3VycmVudCByb3VuZC5cbiAgLy8gaWYgcGxheWVyIHBhc3NlcyB0ZXN0ICsxIGlzIGFkZGVkIHRvIHJvdW5kIGxlbmd0aCBhbmQgcGxheWJhY2sgc3RhcnRzIGFnYWluLlxuXG4gIGZ1bmN0aW9uIGNvbXBhcmVBcnJheXMoKSB7XG4gICAgY29uc3QgdGhlU2FtZSA9IHVzZXJTZXF1ZW5jZS5sZW5ndGggPT09IHByb2dyYW1TZXF1ZW5jZS5sZW5ndGggJiYgdXNlclNlcXVlbmNlLmV2ZXJ5KCh2LGkpID0+IHYgPT09IHByb2dyYW1TZXF1ZW5jZVtpXS5hdWRpbyk7XG4gICAgY291bnQgKz0gMTtcbiAgICBpZiAoKGNvdW50ID09PSBjdXJyZW50Um91bmQpICYmIChsb3NzZXMgPT09IDApICYmIChtZXNzaW5nICE9PSB0cnVlKSAmJiAocGxheWluZyA9PT0gdHJ1ZSkpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoZVNhbWUpO1xuICAgICAgaWYgKHRoZVNhbWUpIHtcbiAgICAgICAgY3VycmVudFJvdW5kICs9IDE7XG4gICAgICAgIHJvdW5kQWRkTWF0aCgpO1xuICAgICAgICByb3VuZFJlc2V0KCk7XG4gICAgICAgICRmZWVkYmFjay5odG1sKCdQYXNzISAtIG5leHQgdXAgJyArIGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZG9jdW1lbnQudW5iaW5kKCdrZXlwcmVzcycsIGtleUxpc3RlbmVyKTtcbiAgICAgICAgc2V0VGltZW91dChwbGF5QmFjaywgMzAwMCk7XG4gICAgICB9IGVsc2UgaWYgKCF0aGVTYW1lICYmICFtZXNzaW5nKSB7XG4gICAgICAgIGxvc3NlcyArPSAxO1xuICAgICAgICByb3VuZFJlc2V0KCk7XG4gICAgICAgICRkb2N1bWVudC51bmJpbmQoJ2tleXByZXNzJywga2V5TGlzdGVuZXIpO1xuICAgICAgICBzZXRUaW1lb3V0KHBsYXlCYWNrLCAzMDAwKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoJ0ZhaWwhIHN1ZGRlbiBkZWF0aCEhIC1uZXh0IHVwICcgKyBjdXJyZW50UGxheWVyKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuXG4gICAgICAgIC8vdGhpcyBib3R0b20gcGFydCBvZiB0aGUgaWYgZWxzZSBhY3RzIGFzIHRoZSBzdWRkZW4gZGVhdGggY2FsY3VsYXRvciBwb3J0aW9uIG9mIHRoZSBnYW1lLCB3b3JrcyBvbiB3aGV0aGVyIGEgbG9zcyB3YXMgc3RvcmVkIGluIHRoZSAnbG9zc2VzJyB2YXIuXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChjb3VudCA9PT0gY3VycmVudFJvdW5kICYmIGxvc3NlcyAhPT0gMCAmJiAhbWVzc2luZyl7XG4gICAgICBpZiAodGhlU2FtZSA9PT0gdHJ1ZSkge1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyICsgJyBXaW5zIScpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICB9IGVsc2UgaWYgKCF0aGVTYW1lICYmICFtZXNzaW5nKSB7XG4gICAgICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIgKyAnIEZhaWxzISEgLS0tLSBUSUUhJyk7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRlbmRHYW1lLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20gdGhlIGNvbXBhcmUgYXJyYXlzIGZ1bmN0aW9uIGFuZCB1cHMgdGhlIHByb2dyYW0gYXJyYXkgYnkgMSByYW5kb21seSBnZW5lcmF0ZWQgbnVtYmVyLlxuICBmdW5jdGlvbiByb3VuZEFkZE1hdGggKCkge1xuICAgIGNvbnN0IHJhbmQgPSAoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjgpKTtcbiAgICBwcm9ncmFtU2VxdWVuY2UucHVzaCh2aXN1YWxzW3NvdW5kc1tyYW5kXV0pO1xuICB9XG5cblxuICAvLyB0aGlzIHJlc2V0cyB0aGUgcm91bmQgYWZ0ZXIgYSBmaXJzdCB0aW1lIHdpbiBvciBmYWlsLCBhbGxvd2luZyBmb3IgdGhlIGN1cnJlbnQgcGxheWVyIHRvIGNoYW5nZSBidXQgbm90IHRoZSByb3VuZCBudW1iZXIgZm9yIHN1ZGRlbiBkZWF0aC5cbiAgZnVuY3Rpb24gcm91bmRSZXNldCAoKSB7XG4gICAgdXNlclNlcXVlbmNlID0gW107XG4gICAgY291bnQgPSAwO1xuICAgIGN1cnJlbnRQbGF5ZXJOdW0gKz0gMTtcbiAgICB1cGRhdGVQbGF5ZXIoKTtcbiAgfVxuXG4gIC8vdXBkYXRlcyB0aGUgY3VycmVudCBwbGF5ZXIgYXMgdGhlIHJvdW5kcyBpbmNyZWFzZS0gaGFzIHRvIGJlIGN1cnJlbnQgcGxheWVyIG51bSBkdWUgdG8gdGhlIGN1cnJlbnQgcGxheWVyIG5lZWRpbmcgdG8gdXBkYXRlIGluZGVwZW5kZW50bHkgZnJvbSB0aGUgY3VycmVudCByb3VuZCBmb3IgdGhlIHN1ZGRlbiBkZWF0aCByb3VuZFxuICBmdW5jdGlvbiB1cGRhdGVQbGF5ZXIgKCkge1xuICAgIGlmIChjdXJyZW50UGxheWVyTnVtICUgMiA9PT0gMCkge1xuICAgICAgY3VycmVudFBsYXllciA9ICdQbGF5ZXIgMic7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSAnUGxheWVyIDEnO1xuICAgIH1cbiAgfVxuXG4gICRlbmRHYW1lLm9uKCdjbGljaycsICgpID0+IHtcbiAgICBwbGF5aW5nID0gZmFsc2U7XG4gICAgbWVzc2luZyA9IGZhbHNlO1xuICAgIGxvc3NlcyA9IDA7XG4gICAgY291bnQgPSAwO1xuICAgICRmZWVkYmFjay5odG1sKCcnKTtcbiAgICAkd2VsY29tZS5zaG93KCk7XG4gICAgJGVuZEdhbWUuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICRkb2N1bWVudC51bmJpbmQoJ2tleXByZXNzJywga2V5TGlzdGVuZXIpO1xuICB9KTtcblxuXG59KTtcblxuXG5cbi8vdG8gZG8gLSBtYWtlIHRoZSBrZXkgbGlzdGVuIG9ubHkgd29yayBvbmNlIHRoZSBrZXkgaGFzIHBsYXllZCBiYWNrXG4vL21hc3NpdmVseSByZWR1Y2UgdGhlIGNvbXBhcmUgYXJyYXlzIGZ1bmN0aW9uLCBtYXliZSBtb3ZlIGFkZCBtYXRoIG91dC5cbiJdfQ==
