"use strict";$(function(){function e(){b=[],w=[],k=3,T=k,l(),B=0,D=0,M="Player 1"}function n(e){if((x||P)&&g[e.key]){var n=g[e.key],a=e.key;s(n),b.push(parseInt(e.key)),O.removeClass("hiddener"),O.html(a),setTimeout(t,500),d()}}function a(e){O.removeClass("hiddener"),O.html(e),setTimeout(t,500)}function t(){O.addClass("hiddener")}function i(){for(var e=0;e<k;e++){var n=Math.floor(8*Math.random());w.push(g[I[n]])}o()}function o(){setTimeout(function(){z<k?(s(w[z]),p.addClass("hidden"),p.html(M),console.log(w[z].audio),o(),z++):(z=0,r.keypress(n))},1e3)}function s(e){h.src="src/assets/audio/"+e.audio+".wav",h.play(),a(e.audio);var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function d(){var e=b.length===w.length&&b.every(function(e,n){return e===w[n].audio});D+=1,D===k&&0===B&&!0!==P&&!0===x?(console.log(e),e?(k+=1,u(),m(),p.html("Pass! - next up "+M),p.removeClass("hidden"),r.unbind("keypress",n),setTimeout(o,3e3)):e||P||(B+=1,m(),r.unbind("keypress",n),setTimeout(o,3e3),p.html("Fail! sudden death!! -next up "+M),p.removeClass("hidden"))):D!==k||0===B||P||(!0===e?(p.html(M+" Wins!"),p.removeClass("hidden"),C.removeClass("hidden")):e||P||(p.html(M+" Fails!! ---- TIE!"),p.removeClass("hidden"),C.removeClass("hidden")))}function u(){var e=Math.floor(8*Math.random());w.push(g[I[e]])}function m(){b=[],D=0,T+=1,l()}function l(){M=T%2==0?"Player 2":"Player 1"}console.log("JS yo");var r=$(document),h=$("audio")[0],c=$(".welcome"),f=$("#game"),v=$("#playground"),p=$(".feedback"),C=($(".reset"),$(".endgame")),y=$(".switch"),O=$(".numberDisplay"),I=[1,2,3,4,5,6,7,8],g={1:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:1},2:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:2},3:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:3},4:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:4},5:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:5},6:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:6},7:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:7},8:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:8}},k=3,T=k,w=[],b=[],M="player 1",P=!1,x=!1;f.on("click",function(){c.hide(),x=!0,e(),p.removeClass("hidden"),p.html(M),setTimeout(i,3e3)}),v.on("click",function(){c.hide(),P=!0,C.removeClass("hidden"),e(),r.keypress(n)}),y.on("change",function(){console.log("checked"),O.toggleClass("hidden")});var z=0,B=0,D=0;C.on("click",function(){x=!1,P=!1,B=0,D=0,p.html(""),c.show(),C.addClass("hidden"),r.unbind("keypress",n)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiYnVpbGRHYW1lIiwidXNlclNlcXVlbmNlIiwicHJvZ3JhbVNlcXVlbmNlIiwiY3VycmVudFJvdW5kIiwiY3VycmVudFBsYXllck51bSIsInVwZGF0ZVBsYXllciIsImxvc3NlcyIsImNvdW50Iiwia2V5TGlzdGVuZXIiLCJlIiwicGxheWluZyIsInZpc3VhbHMiLCJrZXkiLCJtZXNzaW5nIiwidmlzdWFsaXNlIiwic2tleSIsInB1c2giLCJwYXJzZUludCIsIiRudW1iZXJEaXNwbGF5IiwicmVtb3ZlQ2xhc3MiLCJzZXRUaW1lb3V0IiwiaHRtbCIsImhpZGVLZXkiLCJhZGRDbGFzcyIsImdhbWVJbml0IiwicGxheUJhY2siLCJyYW5kIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic291bmRzIiwiJGZlZWRiYWNrIiwiY29uc29sZSIsInNlcXVlbmNlSW5kZXgiLCIkZG9jdW1lbnQiLCJrZXlwcmVzcyIsImF1ZGlvIiwiJGVsZW1lbnQiLCJlYXN5UGxheSIsImVsZW1lbnQiLCJjbG9uZSIsImFuaW1hdGlvbkluIiwiYW5pbWF0aW9uT3V0IiwicmVtb3ZlIiwidGhlU2FtZSIsImxlbmd0aCIsImV2ZXJ5IiwidiIsImkiLCJyb3VuZEFkZE1hdGgiLCJyb3VuZFJlc2V0IiwiY3VycmVudFBsYXllciIsInVuYmluZCIsIiRlbmRHYW1lIiwib24iLCJsb2ciLCJkb2N1bWVudCIsIiR3ZWxjb21lIiwiJGdhbWUiLCIkcGxheWdyb3VuZCIsIiRyZXNldCIsIjEiLCJoaWRlIiwiJHN3aXRjaCIsInRvZ2dsZUNsYXNzIiwic2hvdyJdLCJtYXBwaW5ncyI6IllBQUFBLEdBQUUsV0FtR0EsUUFBQUMsS0FDQUMsS0FDRUEsS0FDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFDQUMsSUFDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFDQUMsRUFBQSxXQUlGLFFBQUFDLEdBQUFDLEdBQ0EsSUFBQUMsR0FBU0YsSUFBZUcsRUFBQUYsRUFBQUcs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Q1g0QyxFQUFBVCxHQUFBLFNBQUEsV0FDQVMsUUFBQVIsSUFBVyxXQUNUdkIsRUFBWWdDLFlBQVosV0FzQ0UsSUFBQS9CLEdBQUlBLEVBdUNOM0IsRUFBTXNDLEVBQStFckMsRUFBU3dDLENBcUU5RmIsR0FBQUEsR0FBVWtCLFFBQU8sV0FSbkIxQyxHQUFBLEVBelFGRyxHQUFBLEVBNFFJUCxFQUFTLEVBYWJDLEVBQUEsRUFDQXdCLEVBQUFWLEtBQUEsSUFYSW9DLEVBQVNRLE9BQ1RaLEVBQVM5QixTQUFTLFVBQ2xCVyxFQUFVa0IsT0FBTyxXQUFZNUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdKUyB5bycpO1xuXG4gIGNvbnN0ICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpO1xuICBjb25zdCBhdWRpbyA9ICQoJ2F1ZGlvJylbMF07XG4gIGNvbnN0ICR3ZWxjb21lID0gJCgnLndlbGNvbWUnKTtcbiAgY29uc3QgJGdhbWUgPSAkKCcjZ2FtZScpO1xuICBjb25zdCAkcGxheWdyb3VuZCA9ICQoJyNwbGF5Z3JvdW5kJyk7XG4gIGNvbnN0ICRmZWVkYmFjayA9ICQoJy5mZWVkYmFjaycpO1xuICBjb25zdCAkcmVzZXQgPSAkKCcucmVzZXQnKTtcbiAgY29uc3QgJGVuZEdhbWUgPSAkKCcuZW5kZ2FtZScpO1xuICBjb25zdCAkc3dpdGNoID0gJCgnLnN3aXRjaCcpO1xuICBjb25zdCAkbnVtYmVyRGlzcGxheSA9ICQoJy5udW1iZXJEaXNwbGF5JylcblxuICBjb25zdCBzb3VuZHMgPSBbMSwgMiwgMywgNCwgNSwgNiwgNywgOF07XG4gIGNvbnN0IHZpc3VhbHMgPSB7XG4gICAgMToge1xuICAgICAgZWxlbWVudDogJCgnLmZpcnN0JyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZhZGVJbkRvd25CaWcnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnem9vbU91dCcsXG4gICAgICBhdWRpbzogMVxuICAgIH0sXG4gICAgMjoge1xuICAgICAgZWxlbWVudDogJCgnLnNlY29uZCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICd6b29tSW4nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogMlxuICAgIH0sXG4gICAgMzoge1xuICAgICAgZWxlbWVudDogJCgnLnRoaXJkJyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZsYXNoJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDNcbiAgICB9LFxuICAgIDQ6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5mb3VydGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAncm90YXRlSW4nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAncm90YXRlT3V0JyxcbiAgICAgIGF1ZGlvOiA0XG4gICAgfSxcbiAgICA1OiB7XG4gICAgICBlbGVtZW50OiAkKCcuZmlmdGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmxhc2h0d28nLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogNVxuICAgIH0sXG4gICAgNjoge1xuICAgICAgZWxlbWVudDogJCgnLnNpeHRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ2ZhZGVJblVwQmlnJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2xpZ2h0U3BlZWRPdXQnLFxuICAgICAgYXVkaW86IDZcbiAgICB9LFxuICAgIDc6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5zZXZlbnRoJyksXG4gICAgICBhbmltYXRpb25JbjogJ3NoYWtlJyxcbiAgICAgIGFuaW1hdGlvbk91dDogJ2ZhZGVPdXQnLFxuICAgICAgYXVkaW86IDdcbiAgICB9LFxuICAgIDg6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5laWdodGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnc2xpZGVJbkxlZnQnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogOFxuICAgIH1cblxuICB9O1xuXG4gIC8vIGN1cnJlbnQgcm91bmQuIGVtcHR5IHByb2dyYW1TZXF1ZW5jZSBhcnJheSxcbiAgLy9nZXRzIGZpbGxlZCB4MyBhdCBzdGFydCB0aGVuIGlzICsxIHBlciByb3VuZFxuICBsZXQgY3VycmVudFJvdW5kID0gMztcbiAgbGV0IGN1cnJlbnRQbGF5ZXJOdW0gPSBjdXJyZW50Um91bmQ7XG4gIGxldCBwcm9ncmFtU2VxdWVuY2UgPSBbXTtcbiAgbGV0IHVzZXJTZXF1ZW5jZSA9IFtdO1xuICBsZXQgY3VycmVudFBsYXllciA9ICdwbGF5ZXIgMSc7XG5cbiAgLy9QbGF5aW5nL21lc3NpbmcgbW9kZSB2YXJzIGZvciBnYW1lIG9yIHBsYXlncm91bmRcbiAgbGV0IG1lc3NpbmcgPSBmYWxzZTtcbiAgbGV0IHBsYXlpbmcgPSBmYWxzZTtcblxuICAvL2dhbWUgYnV0dG9uIGNsaWNrIGZ1bmN0aW9uLSBzaG93cyBjdXJyZW50IHBsYXllciwgc3dpdGNoZXMgcGxheWluZyB0byB0cnVlIGFuZCAgbGF1bmNoZXMgdGhlIGtleSBsaXN0ZW5lciBhbmQgdGhlIGJ1aWxkZ2FtZSBmdW5jdGlvbi5cbiAgJGdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICR3ZWxjb21lLmhpZGUoKTtcbiAgICBwbGF5aW5nID0gdHJ1ZTtcbiAgICBidWlsZEdhbWUoKTtcbiAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIpO1xuICAgIHNldFRpbWVvdXQoZ2FtZUluaXQsIDMwMDApO1xuICB9KTtcblxuICAvL3BsYXlncm91bmQgYnV0dG9uIGtleSBsaXN0ZW5lci5cbiAgJHBsYXlncm91bmQub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICR3ZWxjb21lLmhpZGUoKTtcbiAgICBtZXNzaW5nID0gdHJ1ZTtcbiAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgYnVpbGRHYW1lKCk7XG4gICAgJGRvY3VtZW50LmtleXByZXNzKGtleUxpc3RlbmVyKTtcblxuICB9KTtcblxuICAvL3NldHMgdGhlIGdhbWUgYm9hcmQgdXAgYXMgaXQgc2hvdWxkIGJlIGF0IHRoZSBiZWdpbm5pbmcgb2Ygcm91bmQtIGVzcGVjaWFsbHkgbWF0dGVycyBhZnRlciB0aGUgcmVzZXQgaXMgcHJlc3NlZC5cbiAgZnVuY3Rpb24gYnVpbGRHYW1lKCkge1xuICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgIHByb2dyYW1TZXF1ZW5jZSA9IFtdO1xuICAgIGN1cnJlbnRSb3VuZCA9IDM7XG4gICAgY3VycmVudFBsYXllck51bSA9IGN1cnJlbnRSb3VuZDtcbiAgICB1cGRhdGVQbGF5ZXIoKTtcbiAgICBsb3NzZXMgPSAwO1xuICAgIGNvdW50ID0gMDtcbiAgICBjdXJyZW50UGxheWVyID0gJ1BsYXllciAxJztcbiAgfVxuXG4gIC8vYWN0aXZhdGVzIHRoZSBrZXkgbGlzdGVuZXIgZnVuY3Rpb24gd2hlbiBjYWxsZWQgYW5kIGF0dGFjaGVkIHRvIHRoZSBkb2N1bWVudCBmcm9tIHRoZSBnYW1lL3BsYXlncm91bmQgYnV0dG9ucy4gdGhlbiBwdXNoZXMgdGhlIGtleSBjb2RlICgxLTgpIGRvd24gdG8gdGhlIHZpc3VhbGlzZSBmdW5jdGlvbiBhbmQgbnVtYmVyRGlzcGxheSBlbGVtZW50KGZvciB0aGUgZWFzeSBtb2RlKS5cbiAgZnVuY3Rpb24ga2V5TGlzdGVuZXIoZSkge1xuICAgIGlmICgocGxheWluZyB8fCBtZXNzaW5nKSAmJiB2aXN1YWxzW2Uua2V5XSkge1xuICAgICAgY29uc3Qga2V5ID0gdmlzdWFsc1tlLmtleV07XG4gICAgICBjb25zdCBza2V5ID0gZS5rZXk7XG4gICAgICB2aXN1YWxpc2Uoa2V5KTtcbiAgICAgIHVzZXJTZXF1ZW5jZS5wdXNoKHBhcnNlSW50KGUua2V5KSk7XG4gICAgICAkbnVtYmVyRGlzcGxheS5yZW1vdmVDbGFzcygnaGlkZGVuZXInKTtcbiAgICAgICRudW1iZXJEaXNwbGF5Lmh0bWwoc2tleSk7XG4gICAgICBzZXRUaW1lb3V0KGhpZGVLZXksIDUwMCk7XG4gICAgICBjb21wYXJlQXJyYXlzKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gYWN0aXZhdGVzIHRoZSBoYXJkIG1vZGUgd2hlbiBidXR0b24gaXMgY2hlY2tlZCwgcmVtb3ZpbmcgdGhlIGxhcmdlIG51bWJlcnNcbiAgJHN3aXRjaC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdjaGVja2VkJyk7XG4gICAgJG51bWJlckRpc3BsYXkudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gIH0pO1xuXG5cbiAgLy90aGlzIGZ1bmN0aW9uIHRha2VzIHRoZSBrZXlzIHB1c2hlZCBmcm9tIHRoZSB2aXN1YWxzIGZ1bmN0aW9uIGFuZCB0cmFuc2xhdGVzIHRoZW0gaW50byB0aGUgZWFzeW1vZGUgbGFyZ2UgbnVtYmVycyBvbiBzY3JlZW5cbiAgZnVuY3Rpb24gZWFzeVBsYXkgKGtleSkge1xuICAgICRudW1iZXJEaXNwbGF5LnJlbW92ZUNsYXNzKCdoaWRkZW5lcicpO1xuICAgICRudW1iZXJEaXNwbGF5Lmh0bWwoa2V5KTtcbiAgICBzZXRUaW1lb3V0KGhpZGVLZXksIDUwMCk7XG5cbiAgfVxuXG5cbiAgLy9oaWRlcyB0aGUgZWFzeSBudW1zIGFmdGVyIHRoZSB0aW1lIGRpY3RhdGVkIGluIHRoZSBmdW5jdGlvbnMgYWJvdmUuXG4gIGZ1bmN0aW9uIGhpZGVLZXkoKSB7XG4gICAgJG51bWJlckRpc3BsYXkuYWRkQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gIH1cblxuXG4gIC8vaW5pdGlhbGl6ZXMgdGhlIGJ1aWxkaW5nIG9mIHRoZSBwcm9ncmFtIGFycmF5LCBnZW5lcmF0ZXMgYSBudW1iZXIgZnJvbSAxLTggcmFuZG9tbHkgYW5kICozIHRvIGNyZWF0ZSBmaXJzdCBhcnJheS5cbiAgZnVuY3Rpb24gZ2FtZUluaXQgKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFJvdW5kOyBpKyspe1xuICAgICAgY29uc3QgcmFuZCA9IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqOCkpO1xuICAgICAgcHJvZ3JhbVNlcXVlbmNlLnB1c2godmlzdWFsc1tzb3VuZHNbcmFuZF1dKTtcbiAgICB9XG4gICAgcGxheUJhY2soKTtcbiAgfVxuXG5cbiAgLy9hbGxvd3MgdGhlIHNlcXVlbmNlIHRvIHJlc3RhcnQgYWZ0ZXIgdGhlIGxhc3Qgcm91bmQsIHN0b3BwaW5nIGl0IGZyb20ganVzdCBwbGF5aW5nIHRoZSBlbmQgbnVtYmVyLlxuXG4gIGxldCBzZXF1ZW5jZUluZGV4ID0gMDtcblxuICAvL3RoaXMgcGxheXMgYmFjayB0aGUgY29uc3RydWN0ZWQgcHJvZ3JhbSBhcnJheSBmcm9tIHN0YXJ0IHRvIGZpbmlzaC4gYWxzbyBoaWRlcyB0aGUgY3VycmVudCBwbGF5ZXIgZmVlZGJhY2suIGFuZCBjb25zb2xlIGxvZ3MgdGhlIHByb2dyYW0gc2VxIGFycmF5IGZvciBjaGVhdGluZy5cbiAgZnVuY3Rpb24gcGxheUJhY2soKSB7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoc2VxdWVuY2VJbmRleCA8IGN1cnJlbnRSb3VuZCkge1xuICAgICAgICB2aXN1YWxpc2UocHJvZ3JhbVNlcXVlbmNlW3NlcXVlbmNlSW5kZXhdKTtcbiAgICAgICAgJGZlZWRiYWNrLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2dyYW1TZXF1ZW5jZVtzZXF1ZW5jZUluZGV4XS5hdWRpbyk7XG4gICAgICAgIHBsYXlCYWNrKCk7XG4gICAgICAgIHNlcXVlbmNlSW5kZXgrKztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNlcXVlbmNlSW5kZXggPSAwO1xuICAgICAgICAkZG9jdW1lbnQua2V5cHJlc3Moa2V5TGlzdGVuZXIpO1xuICAgICAgfVxuICAgIH0sIDEwMDApO1xuICB9XG5cbiAgLy90YWtlcyB0aGUgY29kZSBwdXNoZWQgZG93biBmcm9tIHRoZSBrZXlsaXN0ZW5lciBhbmQgdGhlIHBsYXliYWNrIGFuZCB0cmFuc2xhdGVzIGl0IHRvIHBsYXkgdGhlIGF1ZGlvIHNyYyBhbmQgYW5pbWF0ZSB0aGUgZGl2cyBhdCB0aGUgc2FtZSB0aW1lLiBjbG9uZXMgdGhlIHJlbGV2YW50IGRpdiBhbmQgYXBwZW5kcyBpdCB0byB0aGUgYm9keSBhbHNvLCBhbGxvd2luZyBmb3Igb3ZlcmxhcHMuIHRoZW4gZGVsZXRlcyBpdHNlbGYgYWZ0ZXIgbmVhcmx5IDIgc2Vjcy5cblxuICBmdW5jdGlvbiB2aXN1YWxpc2UgKGtleSkge1xuICAgIGF1ZGlvLnNyYyA9IGBzcmMvYXNzZXRzL2F1ZGlvLyR7a2V5LmF1ZGlvfS53YXZgO1xuICAgIGF1ZGlvLnBsYXkoKTtcbiAgICBlYXN5UGxheShrZXkuYXVkaW8pO1xuICAgIGNvbnN0ICRlbGVtZW50ID0ga2V5LmVsZW1lbnQuY2xvbmUoKTtcbiAgICAkZWxlbWVudC5hcHBlbmRUbygnbWFpbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5hZGRDbGFzcyhrZXkuYW5pbWF0aW9uSW4pLnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25PdXQpO1xuICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25JbikuYWRkQ2xhc3Moa2V5LmFuaW1hdGlvbk91dCk7XG4gICAgfSwgMTIwMCk7XG4gICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSwgMTkwMCk7XG5cbiAgfVxuXG5cbiAgbGV0IGxvc3NlcyA9IDA7XG4gIGxldCBjb3VudCAgPSAwO1xuXG4gIC8vIGNvbXBhcmVzIHRoZSB0d28gYXJyYXlzIHdoZW4gdGhlIGxlbmd0aCBtYXRjaGVzIHRoZSBjdXJyZW50IHJvdW5kLlxuICAvLyBpZiBwbGF5ZXIgcGFzc2VzIHRlc3QgKzEgaXMgYWRkZWQgdG8gcm91bmQgbGVuZ3RoIGFuZCBwbGF5YmFjayBzdGFydHMgYWdhaW4uXG5cbiAgZnVuY3Rpb24gY29tcGFyZUFycmF5cygpIHtcbiAgICBjb25zdCB0aGVTYW1lID0gdXNlclNlcXVlbmNlLmxlbmd0aCA9PT0gcHJvZ3JhbVNlcXVlbmNlLmxlbmd0aCAmJiB1c2VyU2VxdWVuY2UuZXZlcnkoKHYsaSkgPT4gdiA9PT0gcHJvZ3JhbVNlcXVlbmNlW2ldLmF1ZGlvKTtcbiAgICBjb3VudCArPSAxO1xuICAgIGlmICgoY291bnQgPT09IGN1cnJlbnRSb3VuZCkgJiYgKGxvc3NlcyA9PT0gMCkgJiYgKG1lc3NpbmcgIT09IHRydWUpICYmIChwbGF5aW5nID09PSB0cnVlKSkge1xuICAgICAgY29uc29sZS5sb2codGhlU2FtZSk7XG4gICAgICBpZiAodGhlU2FtZSkge1xuICAgICAgICBjdXJyZW50Um91bmQgKz0gMTtcbiAgICAgICAgcm91bmRBZGRNYXRoKCk7XG4gICAgICAgIHJvdW5kUmVzZXQoKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoJ1Bhc3MhIC0gbmV4dCB1cCAnICsgY3VycmVudFBsYXllcik7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRkb2N1bWVudC51bmJpbmQoJ2tleXByZXNzJywga2V5TGlzdGVuZXIpO1xuICAgICAgICBzZXRUaW1lb3V0KHBsYXlCYWNrLCAzMDAwKTtcbiAgICAgIH0gZWxzZSBpZiAoIXRoZVNhbWUgJiYgIW1lc3NpbmcpIHtcbiAgICAgICAgbG9zc2VzICs9IDE7XG4gICAgICAgIHJvdW5kUmVzZXQoKTtcbiAgICAgICAgJGRvY3VtZW50LnVuYmluZCgna2V5cHJlc3MnLCBrZXlMaXN0ZW5lcik7XG4gICAgICAgIHNldFRpbWVvdXQocGxheUJhY2ssIDMwMDApO1xuICAgICAgICAkZmVlZGJhY2suaHRtbCgnRmFpbCEgc3VkZGVuIGRlYXRoISEgLW5leHQgdXAgJyArIGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG5cbiAgICAgICAgLy90aGlzIGJvdHRvbSBwYXJ0IG9mIHRoZSBpZiBlbHNlIGFjdHMgYXMgdGhlIHN1ZGRlbiBkZWF0aCBjYWxjdWxhdG9yIHBvcnRpb24gb2YgdGhlIGdhbWUsIHdvcmtzIG9uIHdoZXRoZXIgYSBsb3NzIHdhcyBzdG9yZWQgaW4gdGhlICdsb3NzZXMnIHZhci5cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNvdW50ID09PSBjdXJyZW50Um91bmQgJiYgbG9zc2VzICE9PSAwICYmICFtZXNzaW5nKXtcbiAgICAgIGlmICh0aGVTYW1lID09PSB0cnVlKSB7XG4gICAgICAgICRmZWVkYmFjay5odG1sKGN1cnJlbnRQbGF5ZXIgKyAnIFdpbnMhJyk7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRlbmRHYW1lLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgIH0gZWxzZSBpZiAoIXRoZVNhbWUgJiYgIW1lc3NpbmcpIHtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllciArICcgRmFpbHMhISAtLS0tIFRJRSEnKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy9mdW5jdGlvbiBpcyBjYWxsZWQgZnJvbSB0aGUgY29tcGFyZSBhcnJheXMgZnVuY3Rpb24gYW5kIHVwcyB0aGUgcHJvZ3JhbSBhcnJheSBieSAxIHJhbmRvbWx5IGdlbmVyYXRlZCBudW1iZXIuXG4gIGZ1bmN0aW9uIHJvdW5kQWRkTWF0aCAoKSB7XG4gICAgY29uc3QgcmFuZCA9IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqOCkpO1xuICAgIHByb2dyYW1TZXF1ZW5jZS5wdXNoKHZpc3VhbHNbc291bmRzW3JhbmRdXSk7XG4gIH1cblxuXG4gIC8vIHRoaXMgcmVzZXRzIHRoZSByb3VuZCBhZnRlciBhIGZpcnN0IHRpbWUgd2luIG9yIGZhaWwsIGFsbG93aW5nIGZvciB0aGUgY3VycmVudCBwbGF5ZXIgdG8gY2hhbmdlIGJ1dCBub3QgdGhlIHJvdW5kIG51bWJlciBmb3Igc3VkZGVuIGRlYXRoLlxuICBmdW5jdGlvbiByb3VuZFJlc2V0ICgpIHtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBjb3VudCA9IDA7XG4gICAgY3VycmVudFBsYXllck51bSArPSAxO1xuICAgIHVwZGF0ZVBsYXllcigpO1xuICB9XG5cbiAgLy91cGRhdGVzIHRoZSBjdXJyZW50IHBsYXllciBhcyB0aGUgcm91bmRzIGluY3JlYXNlLSBoYXMgdG8gYmUgY3VycmVudCBwbGF5ZXIgbnVtIGR1ZSB0byB0aGUgY3VycmVudCBwbGF5ZXIgbmVlZGluZyB0byB1cGRhdGUgaW5kZXBlbmRlbnRseSBmcm9tIHRoZSBjdXJyZW50IHJvdW5kIGZvciB0aGUgc3VkZGVuIGRlYXRoIHJvdW5kXG4gIGZ1bmN0aW9uIHVwZGF0ZVBsYXllciAoKSB7XG4gICAgaWYgKGN1cnJlbnRQbGF5ZXJOdW0gJSAyID09PSAwKSB7XG4gICAgICBjdXJyZW50UGxheWVyID0gJ1BsYXllciAyJztcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudFBsYXllciA9ICdQbGF5ZXIgMSc7XG4gICAgfVxuICB9XG5cbiAgJGVuZEdhbWUub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgIHBsYXlpbmcgPSBmYWxzZTtcbiAgICBtZXNzaW5nID0gZmFsc2U7XG4gICAgbG9zc2VzID0gMDtcbiAgICBjb3VudCA9IDA7XG4gICAgJGZlZWRiYWNrLmh0bWwoJycpO1xuICAgICR3ZWxjb21lLnNob3coKTtcbiAgICAkZW5kR2FtZS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgJGRvY3VtZW50LnVuYmluZCgna2V5cHJlc3MnLCBrZXlMaXN0ZW5lcik7XG4gIH0pO1xuXG5cbn0pO1xuXG5cblxuLy90byBkbyAtIG1ha2UgdGhlIGtleSBsaXN0ZW4gb25seSB3b3JrIG9uY2UgdGhlIGtleSBoYXMgcGxheWVkIGJhY2tcbi8vbWFzc2l2ZWx5IHJlZHVjZSB0aGUgY29tcGFyZSBhcnJheXMgZnVuY3Rpb24sIG1heWJlIG1vdmUgYWRkIG1hdGggb3V0LlxuIl19
