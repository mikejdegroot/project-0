"use strict";$(function(){function e(){b=[],w=[],k=3,T=k,m(),B=0,D=0}function n(e){if(!0===z||!0===x){var n=y[e.key],i=e.key;s(n),b.push(parseInt(e.key)),O.removeClass("hiddener"),O.html(i),setTimeout(t,500),d()}}function i(e){O.removeClass("hiddener"),O.html(e),setTimeout(t,500)}function t(){O.addClass("hiddener")}function a(){for(var e=0;e<k;e++){var n=Math.floor(8*Math.random());w.push(y[I[n]])}console.log("initializing!"),o()}function o(){b=[],setTimeout(function(){P<k?(o(),s(w[P]),p.addClass("hidden"),p.html(M),console.log(w[P].audio),P++):(P=0,b=[],r.keypress(n))},1e3)}function s(e){h.src="src/assets/audio/"+e.audio+".wav",h.play(),i(e.audio);var n=e.element.clone();n.appendTo("main").removeClass("hidden").addClass(e.animationIn).removeClass(e.animationOut),setTimeout(function(){n.removeClass(e.animationIn).addClass(e.animationOut)},1200),setTimeout(function(){n.remove()},1900)}function d(){var e=b.length===w.length&&b.every(function(e,n){return e===w[n].audio});D+=1,D===k&&0===B&&!0!==x&&!0===z?(console.log(e),!0===e?(k+=1,u(),l(),p.html("Pass! - next up "+M),p.removeClass("hidden"),r.unbind("keypress",n),setTimeout(o,3e3)):!1===e&&!0!==x&&(B+=1,l(),r.unbind("keypress",n),setTimeout(o,3e3),p.html("Fail! sudden death!! -next up "+M),p.removeClass("hidden"))):D===k&&0!==B&&!0!==x&&(!0===e?(p.html(M+" Wins!"),p.removeClass("hidden"),C.removeClass("hidden")):!1===e&&!0!==x&&(p.html(M+" Fails!! ---- TIE!"),p.removeClass("hidden"),C.removeClass("hidden")))}function u(){var e=Math.floor(8*Math.random());w.push(y[I[e]])}function l(){b=[],D=0,T+=1,m()}function m(){M=T%2==0?"Player 2":"Player 1"}console.log("JS yo");var r=$(document),h=$("audio")[0],c=$(".welcome"),f=$("#game"),v=$("#playground"),p=$(".feedback"),C=($(".reset"),$(".endgame")),g=$(".switch"),O=$(".numberDisplay"),I=[1,2,3,4,5,6,7,8],y={1:{element:$(".first"),animationIn:"fadeInDownBig",animationOut:"zoomOut",audio:1},2:{element:$(".second"),animationIn:"zoomIn",animationOut:"fadeOut",audio:2},3:{element:$(".third"),animationIn:"flash",animationOut:"fadeOut",audio:3},4:{element:$(".fourth"),animationIn:"rotateIn",animationOut:"rotateOut",audio:4},5:{element:$(".fifth"),animationIn:"flashtwo",animationOut:"fadeOut",audio:5},6:{element:$(".sixth"),animationIn:"fadeInUpBig",animationOut:"lightSpeedOut",audio:6},7:{element:$(".seventh"),animationIn:"shake",animationOut:"fadeOut",audio:7},8:{element:$(".eighth"),animationIn:"slideInLeft",animationOut:"fadeOut",audio:8}},k=3,T=k,w=[],b=[],M="player 1",x=!1,z=!1;f.on("click",function(){c.hide(),z=!0,p.removeClass("hidden"),p.html(M),e(),setTimeout(a,3e3)}),v.on("click",function(){c.hide(),x=!0,C.removeClass("hidden"),e(),r.keypress(n)}),g.on("change",function(){console.log("checked"),O.toggleClass("hidden")});var P=0,B=0,D=0;C.on("click",function(){z=!1,x=!1,B=0,D=0,p.html(""),c.show(),C.addClass("hidden"),r.unbind("keypress",n)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyIkIiwiYnVpbGRHYW1lIiwidXNlclNlcXVlbmNlIiwicHJvZ3JhbVNlcXVlbmNlIiwiY3VycmVudFJvdW5kIiwiY3VycmVudFBsYXllck51bSIsInVwZGF0ZVBsYXllciIsImxvc3NlcyIsImtleUxpc3RlbmVyIiwiZSIsInBsYXlpbmciLCJtZXNzaW5nIiwia2V5IiwidmlzdWFscyIsInZpc3VhbGlzZSIsInNrZXkiLCJwdXNoIiwicGFyc2VJbnQiLCIkbnVtYmVyRGlzcGxheSIsInJlbW92ZUNsYXNzIiwic2V0VGltZW91dCIsImh0bWwiLCJoaWRlS2V5IiwiYWRkQ2xhc3MiLCJnYW1lSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJpIiwicGxheUJhY2siLCJzb3VuZHMiLCJyYW5kIiwiJGZlZWRiYWNrIiwic2VxdWVuY2VJbmRleCIsImN1cnJlbnRQbGF5ZXIiLCIkZG9jdW1lbnQiLCJrZXlwcmVzcyIsImF1ZGlvIiwiJGVsZW1lbnQiLCJlYXN5UGxheSIsImVsZW1lbnQiLCJjbG9uZSIsImFuaW1hdGlvbkluIiwiYW5pbWF0aW9uT3V0IiwiY291bnQiLCJyZW1vdmUiLCJ0aGVTYW1lIiwibGVuZ3RoIiwiZXZlcnkiLCJ2Iiwicm91bmRBZGRNYXRoIiwicm91bmRSZXNldCIsInVuYmluZCIsIiRlbmRHYW1lIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwib24iLCJkb2N1bWVudCIsIiR3ZWxjb21lIiwiJGdhbWUiLCIkcGxheWdyb3VuZCIsIiRyZXNldCIsIjEiLCJoaWRlIiwiJHN3aXRjaCIsInRvZ2dsZUNsYXNzIiwic2hvdyJdLCJtYXBwaW5ncyI6IllBQUFBLEdBQUUsV0FvR0EsUUFBQUMsS0FDQUMsS0FDRUEsS0FDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFDQUMsSUFDQUMsRUFBQUEsRUFDQUMsRUFBQUEsRUFJRixRQUFBQyxHQUFBQyxHQUNBLElBQVNELElBQVRFLElBQXdCLElBQUFDLEVBQUEsQ0FDdEIsR0FBS0Qs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WUosRUFDVkUsRUFBU0ssWUFBVCxVQUNBcEQsSUFDQXlDLEVBQVNqQyxTQUFBQSxLQStCWDZDLEVBQUFSLEdBQUEsU0FBQSxXQUNBUSxRQUFBdEMsSUFBVyxXQUNURCxFQUFZd0MsWUFBWixXQXVDQTdDLElBQUFBLEdBQVcsRUF5Q1hiLEVBQU1zQyxFQUErRUYsRUFBU0ssQ0FxRTlGZCxHQUFBQSxHQUFVaUIsUUFBTyxXQVJuQnpDLEdBQUEsRUE1UUZDLEdBQUEsRUErUUlKLEVBQVMsRUFhYm9DLEVBQUEsRUFDQVosRUFBQVYsS0FBQSxJQVhJcUMsRUFBU1EsT0FDVGQsRUFBUzdCLFNBQVMsVUFDbEJXLEVBQVVpQixPQUFPLFdBQVkzQyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKCgpID0+IHtcbiAgY29uc29sZS5sb2coJ0pTIHlvJyk7XG5cbiAgY29uc3QgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7XG4gIGNvbnN0IGF1ZGlvID0gJCgnYXVkaW8nKVswXTtcbiAgY29uc3QgJHdlbGNvbWUgPSAkKCcud2VsY29tZScpO1xuICBjb25zdCAkZ2FtZSA9ICQoJyNnYW1lJyk7XG4gIGNvbnN0ICRwbGF5Z3JvdW5kID0gJCgnI3BsYXlncm91bmQnKTtcbiAgY29uc3QgJGZlZWRiYWNrID0gJCgnLmZlZWRiYWNrJyk7XG4gIGNvbnN0ICRyZXNldCA9ICQoJy5yZXNldCcpO1xuICBjb25zdCAkZW5kR2FtZSA9ICQoJy5lbmRnYW1lJyk7XG4gIGNvbnN0ICRzd2l0Y2ggPSAkKCcuc3dpdGNoJyk7XG4gIGNvbnN0ICRudW1iZXJEaXNwbGF5ID0gJCgnLm51bWJlckRpc3BsYXknKVxuXG4gIGNvbnN0IHNvdW5kcyA9IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4XTtcbiAgY29uc3QgdmlzdWFscyA9IHtcbiAgICAxOiB7XG4gICAgICBlbGVtZW50OiAkKCcuZmlyc3QnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmFkZUluRG93bkJpZycsXG4gICAgICBhbmltYXRpb25PdXQ6ICd6b29tT3V0JyxcbiAgICAgIGF1ZGlvOiAxXG4gICAgfSxcbiAgICAyOiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2Vjb25kJyksXG4gICAgICBhbmltYXRpb25JbjogJ3pvb21JbicsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiAyXG4gICAgfSxcbiAgICAzOiB7XG4gICAgICBlbGVtZW50OiAkKCcudGhpcmQnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmxhc2gnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogM1xuICAgIH0sXG4gICAgNDoge1xuICAgICAgZWxlbWVudDogJCgnLmZvdXJ0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdyb3RhdGVJbicsXG4gICAgICBhbmltYXRpb25PdXQ6ICdyb3RhdGVPdXQnLFxuICAgICAgYXVkaW86IDRcbiAgICB9LFxuICAgIDU6IHtcbiAgICAgIGVsZW1lbnQ6ICQoJy5maWZ0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdmbGFzaHR3bycsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA1XG4gICAgfSxcbiAgICA2OiB7XG4gICAgICBlbGVtZW50OiAkKCcuc2l4dGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnZmFkZUluVXBCaWcnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnbGlnaHRTcGVlZE91dCcsXG4gICAgICBhdWRpbzogNlxuICAgIH0sXG4gICAgNzoge1xuICAgICAgZWxlbWVudDogJCgnLnNldmVudGgnKSxcbiAgICAgIGFuaW1hdGlvbkluOiAnc2hha2UnLFxuICAgICAgYW5pbWF0aW9uT3V0OiAnZmFkZU91dCcsXG4gICAgICBhdWRpbzogN1xuICAgIH0sXG4gICAgODoge1xuICAgICAgZWxlbWVudDogJCgnLmVpZ2h0aCcpLFxuICAgICAgYW5pbWF0aW9uSW46ICdzbGlkZUluTGVmdCcsXG4gICAgICBhbmltYXRpb25PdXQ6ICdmYWRlT3V0JyxcbiAgICAgIGF1ZGlvOiA4XG4gICAgfVxuXG4gIH07XG5cbiAgLy8gY3VycmVudCByb3VuZC4gZW1wdHkgcHJvZ3JhbVNlcXVlbmNlIGFycmF5LFxuICAvL2dldHMgZmlsbGVkIHgzIGF0IHN0YXJ0IHRoZW4gaXMgKzEgcGVyIHJvdW5kXG4gIGxldCBjdXJyZW50Um91bmQgPSAzO1xuICBsZXQgY3VycmVudFBsYXllck51bSA9IGN1cnJlbnRSb3VuZDtcbiAgbGV0IHByb2dyYW1TZXF1ZW5jZSA9IFtdO1xuICBsZXQgdXNlclNlcXVlbmNlID0gW107XG4gIGxldCBjdXJyZW50UGxheWVyID0gJ3BsYXllciAxJztcblxuICAvL1BsYXlpbmcvbWVzc2luZyBtb2RlIHZhcnMgZm9yIGdhbWUgb3IgcGxheWdyb3VuZFxuICBsZXQgbWVzc2luZyA9IGZhbHNlO1xuICBsZXQgcGxheWluZyA9IGZhbHNlO1xuXG4gIC8vZ2FtZSBidXR0b24gY2xpY2sgZnVuY3Rpb24tIHNob3dzIGN1cnJlbnQgcGxheWVyLCBzd2l0Y2hlcyBwbGF5aW5nIHRvIHRydWUgYW5kICBsYXVuY2hlcyB0aGUga2V5IGxpc3RlbmVyIGFuZCB0aGUgYnVpbGRnYW1lIGZ1bmN0aW9uLlxuICAkZ2FtZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgJHdlbGNvbWUuaGlkZSgpO1xuICAgIHBsYXlpbmcgPSB0cnVlO1xuICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllcik7XG4gICAgYnVpbGRHYW1lKCk7XG4gICAgLy8gJGRvY3VtZW50LmtleXByZXNzKGtleUxpc3RlbmVyKTtcbiAgICBzZXRUaW1lb3V0KGdhbWVJbml0LCAzMDAwKTtcbiAgfSk7XG5cbiAgLy9wbGF5Z3JvdW5kIGJ1dHRvbiBrZXkgbGlzdGVuZXIuXG4gICRwbGF5Z3JvdW5kLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAkd2VsY29tZS5oaWRlKCk7XG4gICAgbWVzc2luZyA9IHRydWU7XG4gICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgIGJ1aWxkR2FtZSgpO1xuICAgICRkb2N1bWVudC5rZXlwcmVzcyhrZXlMaXN0ZW5lcik7XG5cbiAgfSk7XG5cbiAgLy9zZXRzIHRoZSBnYW1lIGJvYXJkIHVwIGFzIGl0IHNob3VsZCBiZSBhdCB0aGUgYmVnaW5uaW5nIG9mIHJvdW5kLSBlc3BlY2lhbGx5IG1hdHRlcnMgYWZ0ZXIgdGhlIHJlc2V0IGlzIHByZXNzZWQuXG4gIGZ1bmN0aW9uIGJ1aWxkR2FtZSgpIHtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBwcm9ncmFtU2VxdWVuY2UgPSBbXTtcbiAgICBjdXJyZW50Um91bmQgPSAzO1xuICAgIGN1cnJlbnRQbGF5ZXJOdW0gPSBjdXJyZW50Um91bmQ7XG4gICAgdXBkYXRlUGxheWVyKCk7XG4gICAgbG9zc2VzID0gMDtcbiAgICBjb3VudCA9IDA7XG4gIH1cblxuICAvL2FjdGl2YXRlcyB0aGUga2V5IGxpc3RlbmVyIGZ1bmN0aW9uIHdoZW4gY2FsbGVkIGFuZCBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQgZnJvbSB0aGUgZ2FtZS9wbGF5Z3JvdW5kIGJ1dHRvbnMuIHRoZW4gcHVzaGVzIHRoZSBrZXkgY29kZSAoMS04KSBkb3duIHRvIHRoZSB2aXN1YWxpc2UgZnVuY3Rpb24gYW5kIG51bWJlckRpc3BsYXkgZWxlbWVudChmb3IgdGhlIGVhc3kgbW9kZSkuXG4gIGZ1bmN0aW9uIGtleUxpc3RlbmVyKGUpIHtcbiAgICBpZiAoKHBsYXlpbmcgPT09IHRydWUpIHx8IChtZXNzaW5nID09PSB0cnVlKSkge1xuICAgICAgY29uc3Qga2V5ID0gdmlzdWFsc1tlLmtleV07XG4gICAgICBjb25zdCBza2V5ID0gZS5rZXk7XG4gICAgICB2aXN1YWxpc2Uoa2V5KTtcbiAgICAgIHVzZXJTZXF1ZW5jZS5wdXNoKHBhcnNlSW50KGUua2V5KSk7XG4gICAgICAkbnVtYmVyRGlzcGxheS5yZW1vdmVDbGFzcygnaGlkZGVuZXInKTtcbiAgICAgICRudW1iZXJEaXNwbGF5Lmh0bWwoc2tleSk7XG4gICAgICBzZXRUaW1lb3V0KGhpZGVLZXksIDUwMCk7XG4gICAgICBjb21wYXJlQXJyYXlzKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gYWN0aXZhdGVzIHRoZSBoYXJkIG1vZGUgd2hlbiBidXR0b24gaXMgY2hlY2tlZCwgcmVtb3ZpbmcgdGhlIGxhcmdlIG51bWJlcnNcbiAgJHN3aXRjaC5vbignY2hhbmdlJywgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdjaGVja2VkJyk7XG4gICAgJG51bWJlckRpc3BsYXkudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpO1xuXG4gIH0pO1xuXG5cbiAgLy90aGlzIGZ1bmN0aW9uIHRha2VzIHRoZSBrZXlzIHB1c2hlZCBmcm9tIHRoZSB2aXN1YWxzIGZ1bmN0aW9uIGFuZCB0cmFuc2xhdGVzIHRoZW0gaW50byB0aGUgZWFzeW1vZGUgbGFyZ2UgbnVtYmVycyBvbiBzY3JlZW5cbiAgZnVuY3Rpb24gZWFzeVBsYXkgKGtleSkge1xuICAgICRudW1iZXJEaXNwbGF5LnJlbW92ZUNsYXNzKCdoaWRkZW5lcicpO1xuICAgICRudW1iZXJEaXNwbGF5Lmh0bWwoa2V5KTtcbiAgICBzZXRUaW1lb3V0KGhpZGVLZXksIDUwMCk7XG5cbiAgfVxuXG5cbiAgLy9oaWRlcyB0aGUgZWFzeSBudW1zIGFmdGVyIHRoZSB0aW1lIGRpY3RhdGVkIGluIHRoZSBmdW5jdGlvbnMgYWJvdmUuXG4gIGZ1bmN0aW9uIGhpZGVLZXkoKSB7XG4gICAgJG51bWJlckRpc3BsYXkuYWRkQ2xhc3MoJ2hpZGRlbmVyJyk7XG4gIH1cblxuXG4gIC8vaW5pdGlhbGl6ZXMgdGhlIGJ1aWxkaW5nIG9mIHRoZSBwcm9ncmFtIGFycmF5LCBnZW5lcmF0ZXMgYSBudW1iZXIgZnJvbSAxLTggcmFuZG9tbHkgYW5kICozIHRvIGNyZWF0ZSBmaXJzdCBhcnJheS5cbiAgZnVuY3Rpb24gZ2FtZUluaXQgKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFJvdW5kOyBpKyspe1xuICAgICAgY29uc3QgcmFuZCA9IChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqOCkpO1xuICAgICAgcHJvZ3JhbVNlcXVlbmNlLnB1c2godmlzdWFsc1tzb3VuZHNbcmFuZF1dKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ2luaXRpYWxpemluZyEnKTtcbiAgICBwbGF5QmFjaygpO1xuICB9XG5cblxuICAvL2FsbG93cyB0aGUgc2VxdWVuY2UgdG8gcmVzdGFydCBhZnRlciB0aGUgbGFzdCByb3VuZCwgc3RvcHBpbmcgaXQgZnJvbSBqdXN0IHBsYXlpbmcgdGhlIGVuZCBudW1iZXIuXG5cbiAgbGV0IHNlcXVlbmNlSW5kZXggPSAwO1xuXG4gIC8vdGhpcyBwbGF5cyBiYWNrIHRoZSBjb25zdHJ1Y3RlZCBwcm9ncmFtIGFycmF5IGZyb20gc3RhcnQgdG8gZmluaXNoLiBhbHNvIGhpZGVzIHRoZSBjdXJyZW50IHBsYXllciBmZWVkYmFjay4gYW5kIGNvbnNvbGUgbG9ncyB0aGUgcHJvZ3JhbSBzZXEgYXJyYXkgZm9yIGNoZWF0aW5nLlxuICBmdW5jdGlvbiBwbGF5QmFjaygpIHtcbiAgICB1c2VyU2VxdWVuY2UgPSBbXTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChzZXF1ZW5jZUluZGV4IDwgY3VycmVudFJvdW5kKSB7XG4gICAgICAgIHBsYXlCYWNrKCk7XG4gICAgICAgIHZpc3VhbGlzZShwcm9ncmFtU2VxdWVuY2Vbc2VxdWVuY2VJbmRleF0pO1xuICAgICAgICAkZmVlZGJhY2suYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyKTtcbiAgICAgICAgY29uc29sZS5sb2cocHJvZ3JhbVNlcXVlbmNlW3NlcXVlbmNlSW5kZXhdLmF1ZGlvKTtcbiAgICAgICAgc2VxdWVuY2VJbmRleCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VxdWVuY2VJbmRleCA9IDA7XG4gICAgICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgICAgICAkZG9jdW1lbnQua2V5cHJlc3Moa2V5TGlzdGVuZXIpO1xuICAgICAgfVxuICAgIH0sIDEwMDApO1xuICB9XG5cbiAgLy90YWtlcyB0aGUgY29kZSBwdXNoZWQgZG93biBmcm9tIHRoZSBrZXlsaXN0ZW5lciBhbmQgdGhlIHBsYXliYWNrIGFuZCB0cmFuc2xhdGVzIGl0IHRvIHBsYXkgdGhlIGF1ZGlvIHNyYyBhbmQgYW5pbWF0ZSB0aGUgZGl2cyBhdCB0aGUgc2FtZSB0aW1lLiBjbG9uZXMgdGhlIHJlbGV2YW50IGRpdiBhbmQgYXBwZW5kcyBpdCB0byB0aGUgYm9keSBhbHNvLCBhbGxvd2luZyBmb3Igb3ZlcmxhcHMuIHRoZW4gZGVsZXRlcyBpdHNlbGYgYWZ0ZXIgbmVhcmx5IDIgc2Vjcy5cblxuICBmdW5jdGlvbiB2aXN1YWxpc2UgKGtleSkge1xuICAgIGF1ZGlvLnNyYyA9IGBzcmMvYXNzZXRzL2F1ZGlvLyR7a2V5LmF1ZGlvfS53YXZgO1xuICAgIGF1ZGlvLnBsYXkoKTtcbiAgICBlYXN5UGxheShrZXkuYXVkaW8pO1xuICAgIGNvbnN0ICRlbGVtZW50ID0ga2V5LmVsZW1lbnQuY2xvbmUoKTtcbiAgICAkZWxlbWVudC5hcHBlbmRUbygnbWFpbicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKS5hZGRDbGFzcyhrZXkuYW5pbWF0aW9uSW4pLnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25PdXQpO1xuICAgIHNldFRpbWVvdXQoICgpID0+IHtcbiAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKGtleS5hbmltYXRpb25JbikuYWRkQ2xhc3Moa2V5LmFuaW1hdGlvbk91dCk7XG4gICAgfSwgMTIwMCk7XG4gICAgc2V0VGltZW91dCggKCkgPT4ge1xuICAgICAgJGVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSwgMTkwMCk7XG5cbiAgfVxuXG5cbiAgbGV0IGxvc3NlcyA9IDA7XG4gIGxldCBjb3VudCAgPSAwO1xuXG4gIC8vIGNvbXBhcmVzIHRoZSB0d28gYXJyYXlzIHdoZW4gdGhlIGxlbmd0aCBtYXRjaGVzIHRoZSBjdXJyZW50IHJvdW5kLlxuICAvLyBpZiBwbGF5ZXIgcGFzc2VzIHRlc3QgKzEgaXMgYWRkZWQgdG8gcm91bmQgbGVuZ3RoIGFuZCBwbGF5YmFjayBzdGFydHMgYWdhaW4uXG5cbiAgZnVuY3Rpb24gY29tcGFyZUFycmF5cygpIHtcbiAgICBjb25zdCB0aGVTYW1lID0gdXNlclNlcXVlbmNlLmxlbmd0aCA9PT0gcHJvZ3JhbVNlcXVlbmNlLmxlbmd0aCAmJiB1c2VyU2VxdWVuY2UuZXZlcnkoKHYsaSkgPT4gdiA9PT0gcHJvZ3JhbVNlcXVlbmNlW2ldLmF1ZGlvKTtcbiAgICBjb3VudCArPSAxO1xuICAgIGlmICgoY291bnQgPT09IGN1cnJlbnRSb3VuZCkgJiYgKGxvc3NlcyA9PT0gMCkgJiYgKG1lc3NpbmcgIT09IHRydWUpICYmIChwbGF5aW5nID09PSB0cnVlKSkge1xuICAgICAgY29uc29sZS5sb2codGhlU2FtZSk7XG4gICAgICBpZiAodGhlU2FtZSA9PT0gdHJ1ZSkge1xuICAgICAgICBjdXJyZW50Um91bmQgKz0gMTtcbiAgICAgICAgcm91bmRBZGRNYXRoKCk7XG4gICAgICAgIHJvdW5kUmVzZXQoKTtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoJ1Bhc3MhIC0gbmV4dCB1cCAnICsgY3VycmVudFBsYXllcik7XG4gICAgICAgICRmZWVkYmFjay5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICRkb2N1bWVudC51bmJpbmQoJ2tleXByZXNzJywga2V5TGlzdGVuZXIpO1xuICAgICAgICBzZXRUaW1lb3V0KHBsYXlCYWNrLCAzMDAwKTtcbiAgICAgIH0gZWxzZSBpZiAoKHRoZVNhbWUgPT09IGZhbHNlKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpIHtcbiAgICAgICAgbG9zc2VzICs9IDE7XG4gICAgICAgIHJvdW5kUmVzZXQoKTtcbiAgICAgICAgJGRvY3VtZW50LnVuYmluZCgna2V5cHJlc3MnLCBrZXlMaXN0ZW5lcik7XG4gICAgICAgIHNldFRpbWVvdXQocGxheUJhY2ssIDMwMDApO1xuICAgICAgICAkZmVlZGJhY2suaHRtbCgnRmFpbCEgc3VkZGVuIGRlYXRoISEgLW5leHQgdXAgJyArIGN1cnJlbnRQbGF5ZXIpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuXG5cbiAgICAgICAgLy90aGlzIGJvdHRvbSBwYXJ0IG9mIHRoZSBpZiBlbHNlIGFjdHMgYXMgdGhlIHN1ZGRlbiBkZWF0aCBjYWxjdWxhdG9yIHBvcnRpb24gb2YgdGhlIGdhbWUsIHdvcmtzIG9uIHdoZXRoZXIgYSBsb3NzIHdhcyBzdG9yZWQgaW4gdGhlICdsb3NzZXMnIHZhci5cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChjb3VudCA9PT0gY3VycmVudFJvdW5kKSAmJiAobG9zc2VzICE9PSAwKSAmJiAobWVzc2luZyAhPT0gdHJ1ZSkpe1xuICAgICAgaWYgKHRoZVNhbWUgPT09IHRydWUpIHtcbiAgICAgICAgJGZlZWRiYWNrLmh0bWwoY3VycmVudFBsYXllciArICcgV2lucyEnKTtcbiAgICAgICAgJGZlZWRiYWNrLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgJGVuZEdhbWUucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgfSBlbHNlIGlmICgodGhlU2FtZSA9PT0gZmFsc2UpICYmIChtZXNzaW5nICE9PSB0cnVlKSkge1xuICAgICAgICAkZmVlZGJhY2suaHRtbChjdXJyZW50UGxheWVyICsgJyBGYWlscyEhIC0tLS0gVElFIScpO1xuICAgICAgICAkZmVlZGJhY2sucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAkZW5kR2FtZS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvL2Z1bmN0aW9uIGlzIGNhbGxlZCBmcm9tIHRoZSBjb21wYXJlIGFycmF5cyBmdW5jdGlvbiBhbmQgdXBzIHRoZSBwcm9ncmFtIGFycmF5IGJ5IDEgcmFuZG9tbHkgZ2VuZXJhdGVkIG51bWJlci5cbiAgZnVuY3Rpb24gcm91bmRBZGRNYXRoICgpIHtcbiAgICBjb25zdCByYW5kID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSo4KSk7XG4gICAgcHJvZ3JhbVNlcXVlbmNlLnB1c2godmlzdWFsc1tzb3VuZHNbcmFuZF1dKTtcbiAgfVxuXG5cbiAgLy8gdGhpcyByZXNldHMgdGhlIHJvdW5kIGFmdGVyIGEgZmlyc3QgdGltZSB3aW4gb3IgZmFpbCwgYWxsb3dpbmcgZm9yIHRoZSBjdXJyZW50IHBsYXllciB0byBjaGFuZ2UgYnV0IG5vdCB0aGUgcm91bmQgbnVtYmVyIGZvciBzdWRkZW4gZGVhdGguXG4gIGZ1bmN0aW9uIHJvdW5kUmVzZXQgKCkge1xuICAgIHVzZXJTZXF1ZW5jZSA9IFtdO1xuICAgIGNvdW50ID0gMDtcbiAgICBjdXJyZW50UGxheWVyTnVtICs9IDE7XG4gICAgdXBkYXRlUGxheWVyKCk7XG4gIH1cblxuICAvL3VwZGF0ZXMgdGhlIGN1cnJlbnQgcGxheWVyIGFzIHRoZSByb3VuZHMgaW5jcmVhc2UtIGhhcyB0byBiZSBjdXJyZW50IHBsYXllciBudW0gZHVlIHRvIHRoZSBjdXJyZW50IHBsYXllciBuZWVkaW5nIHRvIHVwZGF0ZSBpbmRlcGVuZGVudGx5IGZyb20gdGhlIGN1cnJlbnQgcm91bmQgZm9yIHRoZSBzdWRkZW4gZGVhdGggcm91bmRcbiAgZnVuY3Rpb24gdXBkYXRlUGxheWVyICgpIHtcbiAgICBpZiAoY3VycmVudFBsYXllck51bSAlIDIgPT09IDApIHtcbiAgICAgIGN1cnJlbnRQbGF5ZXIgPSAnUGxheWVyIDInO1xuICAgIH0gZWxzZSB7XG4gICAgICBjdXJyZW50UGxheWVyID0gJ1BsYXllciAxJztcbiAgICB9XG4gIH1cblxuICAkZW5kR2FtZS5vbignY2xpY2snLCAoKSA9PiB7XG4gICAgcGxheWluZyA9IGZhbHNlO1xuICAgIG1lc3NpbmcgPSBmYWxzZTtcbiAgICBsb3NzZXMgPSAwO1xuICAgIGNvdW50ID0gMDtcbiAgICAkZmVlZGJhY2suaHRtbCgnJyk7XG4gICAgJHdlbGNvbWUuc2hvdygpO1xuICAgICRlbmRHYW1lLmFkZENsYXNzKCdoaWRkZW4nKTtcbiAgICAkZG9jdW1lbnQudW5iaW5kKCdrZXlwcmVzcycsIGtleUxpc3RlbmVyKTtcbiAgfSk7XG5cblxufSk7XG5cblxuXG4vL3RvIGRvIC0gbWFrZSB0aGUga2V5IGxpc3RlbiBvbmx5IHdvcmsgb25jZSB0aGUga2V5IGhhcyBwbGF5ZWQgYmFja1xuLy9tYXNzaXZlbHkgcmVkdWNlIHRoZSBjb21wYXJlIGFycmF5cyBmdW5jdGlvbiwgbWF5YmUgbW92ZSBhZGQgbWF0aCBvdXQuXG4iXX0=
